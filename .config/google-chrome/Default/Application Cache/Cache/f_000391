MW.prototype.GXa=fa(223,function(a){this.J=Jb(arguments,0)});function Fvc(a,b,c,d,e){return zDb(a,t(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function RX(a,b){return B(a,2,b)}function SX(a){Ki(this,a,0,-1,null)}u(SX,Ji);function TX(a){Ki(this,a,0,-1,null)}u(TX,Ji);function Gvc(a){return a}var Hvc=[3],Ivc=[1],Jvc=[1],Kvc=[1],Lvc=[1,2],Mvc=[2];
function Nvc(a,b){var c=uc(a,1)?B(a,1):Number.MIN_VALUE;a=uc(a,2)?Ue(a):Number.MAX_VALUE;var d=uc(b,1)?B(b,1):Number.MIN_VALUE;b=uc(b,2)?Ue(b):Number.MAX_VALUE;return b>c&&a>d||c==d&&a==b}function Ovc(a){return gc(Erc,function(b){return b.match(a)}).getName()}function Pvc(a){Ki(this,a,0,-1,null)}u(Pvc,Ji);Pvc.prototype.Of=function(){return L(this,2)};function Qvc(a){Ki(this,a,0,-1,null)}u(Qvc,Ji);Qvc.prototype.getChartType=function(){return L(this,1)};function Rvc(a){Ki(this,a,0,-1,null)}u(Rvc,Ji);
function Svc(a){Ki(this,a,0,-1,Hvc)}u(Svc,Ji);Svc.prototype.getChartType=function(){return L(this,1)};function Tvc(a){Ki(this,a,0,-1,Ivc)}u(Tvc,Ji);function Uvc(a){Ki(this,a,0,-1,Jvc)}u(Uvc,Ji);function Vvc(a){Ki(this,a,0,-1,Kvc)}u(Vvc,Ji);function Wvc(a){Ki(this,a,0,-1,Lvc)}u(Wvc,Ji);var Xvc={DCc:0,EDa:1,cEa:2};function Yvc(a){Ki(this,a,0,-1,Mvc)}u(Yvc,Ji);
var Zvc={N6a:0,SUM:1,AVERAGE:2,fia:3,a7a:4,g6a:5,MEDIAN:6,COUNT:7,c6a:8,d6a:9},$vc={UNKNOWN_ERROR:0,bDc:1,Utc:2,agc:3},awc={PCc:0,ugc:1,tha:2,Ak:3,ICc:4,E7b:5,Khc:6},bwc={NCc:0,vF:1,$tc:2,Htc:3,pwc:4},cwc={JCc:0,Wtc:1,JK:2,qrc:3},dwc={BCc:0,mCc:1,tkc:2,kBc:3,jBc:4,Z$b:5,Yrc:6},ewc={tAc:0,TABLE:1,D1a:2,hCc:3,jzc:4,V4a:5,aDc:6,kBa:7,eza:8,Lza:9,HISTOGRAM:10},fwc={UNKNOWN:0,q7b:1,p7b:2,o7b:3,F8b:4,q$b:5,T$b:6,zdc:7,Xgc:8,Csc:9,Cwc:10,Lwc:11,DAc:12,EAc:13,PBc:14,awc:15};function UX(){A.call(this)}u(UX,A);var gwc=null;UX.prototype.Em=function(){return B(this,1)};function VX(){A.call(this)}u(VX,A);var hwc=null;VX.prototype.getText=function(){return B(this,1)};VX.prototype.ls=function(){return uc(this,1)};function WX(){A.call(this)}u(WX,A);var iwc=null;WX.prototype.getStatus=function(){return B(this,1)};WX.prototype.getError=function(){return B(this,9)};function XX(){A.call(this)}u(XX,A);var jwc=null;function YX(){A.call(this)}u(YX,A);var kwc=null;
function ZX(){A.call(this)}u(ZX,A);var lwc=null;ZX.prototype.sca=function(){return uc(this,1)};ZX.prototype.getType=function(){return B(this,3)};ZX.prototype.setType=function(a){C(this,3,a)};function $X(){A.call(this)}u($X,A);var mwc=null;function aY(){A.call(this)}u(aY,A);var nwc=null;
UX.prototype.Pa=function(){var a=gwc;a||(gwc=a=Bc(UX,{0:{name:"Error",Ob:"ritz.assistant.Error"},1:{name:"message",Na:9,type:String},2:{name:"code",Na:14,defaultValue:0,type:$vc},3:{name:"unsupported_op_reason",Na:14,defaultValue:0,type:awc}}));return a};UX.Pa=UX.prototype.Pa;
VX.prototype.Pa=function(){var a=hwc;a||(hwc=a=Bc(VX,{0:{name:"AnswerQueryPhrase",Ob:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Na:9,type:String},2:{name:"start_byte",Na:5,type:Number},3:{name:"num_bytes",Na:5,type:Number}}));return a};VX.Pa=VX.prototype.Pa;
WX.prototype.Pa=function(){var a=iwc;a||(iwc=a=Bc(WX,{0:{name:"AnswerResponse",Ob:"ritz.assistant.AnswerResponse"},1:{name:"status",Na:5,type:Number},10:{name:"parse_status",Na:14,defaultValue:0,type:bwc},11:{name:"answer_status",Na:14,defaultValue:0,type:cwc},2:{name:"formula",Na:9,type:String},3:{name:"debug_parse_response",Na:9,type:String},4:{name:"interpretation",Na:9,type:String},5:{name:"debug_interpretation_response",Na:9,type:String},6:{name:"unused_phrase",Vc:!0,Na:11,type:VX},7:{name:"used_entity_phrase",
Vc:!0,Na:11,type:VX},8:{name:"unused_entity_phrase",Vc:!0,Na:11,type:VX},9:{name:"error",Na:11,type:UX},12:{name:"alternate_suggestion",Vc:!0,Na:11,type:ZX},14:{name:"deprecated_formula_builder_used",Na:9,type:String},15:{name:"answer_visualization_type",Vc:!0,Na:14,defaultValue:0,type:ewc},16:{name:"formula_builder_used",Na:14,defaultValue:0,type:fwc},17:{name:"charting_info",Na:11,type:YX},18:{name:"answer_field_info",Vc:!0,Na:11,type:XX},19:{name:"charting_formula",Na:9,type:String},21:{name:"parse_info",
Vc:!0,Na:11,type:$X},22:{name:"answer_field_info_for_ranges",Vc:!0,Na:11,type:XX},23:{name:"va_query",Na:9,type:String},24:{name:"pivot_table_def",Na:11,type:Wf}}));return a};WX.Pa=WX.prototype.Pa;XX.prototype.Pa=function(){var a=jwc;a||(jwc=a=Bc(XX,{0:{name:"AnswerFieldInfo",Ob:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",Na:14,defaultValue:0,type:Ufa},2:{name:"range_ref",Na:9,type:String}}));return a};XX.Pa=XX.prototype.Pa;
YX.prototype.Pa=function(){var a=kwc;a||(kwc=a=Bc(YX,{0:{name:"ChartingInfo",Ob:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",Vc:!0,Na:14,defaultValue:0,type:ewc},2:{name:"recommended",Na:8,type:Boolean},3:{name:"user_requested_type",Vc:!0,Na:14,defaultValue:0,type:ewc},4:{name:"show_only_chart",Na:8,type:Boolean}}));return a};YX.Pa=YX.prototype.Pa;
ZX.prototype.Pa=function(){var a=lwc;a||(lwc=a=Bc(ZX,{0:{name:"QuerySuggestion",Ob:"ritz.assistant.QuerySuggestion"},1:{name:"query",Na:9,type:String},2:{name:"formula",Na:9,type:String},3:{name:"type",Na:14,defaultValue:0,type:dwc},4:{name:"deprecated_formula_builder_used",Na:9,type:String},5:{name:"formula_builder_used",Na:14,defaultValue:0,type:fwc}}));return a};ZX.Pa=ZX.prototype.Pa;
$X.prototype.Pa=function(){var a=mwc;a||(mwc=a=Bc($X,{0:{name:"ParseInfo",Ob:"ritz.assistant.ParseInfo"},1:{name:"intent_info",Vc:!0,Na:11,type:aY}}));return a};$X.Pa=$X.prototype.Pa;aY.prototype.Pa=function(){var a=nwc;a||(nwc=a=Bc(aY,{0:{name:"IntentInfo",Ob:"ritz.assistant.IntentInfo"},1:{name:"intent_type",Na:14,defaultValue:0,type:Zvc}}));return a};aY.Pa=aY.prototype.Pa;function bY(a,b,c,d,e,f){G.call(this,a,b);this.C=b;this.va=c;this.$=d||null;this.Ta=e||null;this.J=f||null}u(bY,G);bY.prototype.yj=g("va");bY.prototype.We=g("$");function owc(a,b,c,d,e,f,h){h=void 0===h?null:h;bY.call(this,"Ce",null,d,e,f);this.L=a;this.V=b;this.Ac=c;this.F=h}u(owc,bY);owc.prototype.Fd=g("Ac");function pwc(a,b,c){bY.call(this,"Fe",null,2859);this.L=a;this.V=b;this.F=c}u(pwc,bY);function qwc(a,b,c,d,e,f,h){P.call(this,h);this.F=a;this.D=b;this.J=e;this.Kb=f;this.C=this.Ac=null;this.H=hj(new gj,10).build()}u(qwc,P);p=qwc.prototype;p.Sa=function(){qwc.ea.Sa.call(this);(new ZV(UE,this.D.jf())).send(t(this.Hsb,this,this.D))};p.Pqa=function(a,b){a=new owc(this.F.clone(),this.J,this.Ac,2746,a,b);this.dispatchEvent(a)};p.Hsb=function(a,b){b&&(b.Ki()?rE.fC(this.Ma,b):(b=b.Fd(),a.we(b),tW(a,b),sE(a,"ready",t(this.g4b,this,a)),GW(a,this.Ma,this.Kb,Tn),this.Ac=b))};
p.g4b=function(a){a.jm()&&(sE(a.jm(),"onmouseover",t(this.e4b,this)),sE(a.jm(),"onmouseout",t(this.f4b,this)))};p.e4b=function(){this.C=Ha()};p.f4b=function(){pa(this.C)&&500<Ha()-this.C&&this.Kb.hc(2750,this.H);this.C=null};function cY(){}u(cY,aL);ua(cY);cY.prototype.Ec=n("waffle-assistant-link-button");function rwc(){return W('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function swc(a,b){P.call(this,b);this.D=a;this.C=new Ms("",new cY,this.xa());this.Xa(this.C)}u(swc,P);p=swc.prototype;p.Ha=function(){this.Ma=U(rwc)};p.Sa=function(){swc.ea.Sa.call(this);var a=this.cb("waffle-assistant-feedback-card-link");this.C.pb(a);this.getHandler().R(this.Ma,"mousedown",this.Tg).R(this.C,"action",this.pvb);this.show(!1)};p.Tg=function(a){a.stopPropagation()};
p.show=function(a){var b=this.Ma,c=this.cb("waffle-assistant-feedback-card-link");mq(b,"waffle-assistant-feedback-card-hidden",!a);pn(c,a)};p.pvb=function(){Q.jz.Bc({source:this.D});this.show(!1);this.dispatchEvent(new G("feedback-dialog-opened"))};function dY(){}u(dY,Ks);ua(dY);dY.prototype.Ec=n("waffle-assistant-button");function eY(a,b,c){a&&(q(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Ta(b),Ss(a,b,void 0),doc(a),a.setAttribute("data-tooltip-delay",500),t0b(a,q(c)?c:1))};function twc(){var a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+V(Xt({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+V(Xt({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return W(a)};function fY(a){P.call(this,a);this.C=new Ms("",new dY,this.xa());this.Xa(this.C);this.D=new Ms("",new dY,this.xa());this.Xa(this.D)}u(fY,P);fY.prototype.Ha=function(){this.Ma=U(twc)};fY.prototype.Sa=function(){fY.ea.Sa.call(this);var a=this.cb("waffle-assistant-thumbs-down-button");this.C.pb(a);eY(a,"Not useful");a=this.cb("waffle-assistant-thumbs-up-button");this.D.pb(a);eY(a,"Useful");this.getHandler().R(this.C,"action",this.F).R(this.D,"action",this.H)};
function uwc(a,b){a.xa().qf(a.cb("waffle-assistant-thumbs-text"),b)}fY.prototype.F=function(){this.dispatchEvent(new G("thumbs-down"));N(this.Ma,!1)};fY.prototype.H=function(){this.dispatchEvent(new G("thumbs-up"));N(this.Ma,!1)};function vwc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(V(a.Y9a)+"</span>"),d=0==a.SJa.length;b+='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(d)c=W('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.SJa;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+=(f%2?"":'<div class="waffle-assistant-facet-chart-row">')+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';c=h?c+V(h):c+"(empty)";c+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}c=W(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(Mn?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return W(b)};function wwc(a,b,c,d,e){P.call(this,e);this.J=a;this.Qa=b;this.Kb=c;this.O=d;this.L=zc(this.J,23);this.Ja=B(this.J,22);this.D=B(this.J,26);this.Da=[];this.qd=new ah;this.V=this.F=this.C=null;this.$=!1;this.va=new Us("",this.xa());this.Xa(this.va);this.H=null}u(wwc,P);p=wwc.prototype;p.Ha=function(){wwc.ea.Ha.call(this);this.Ma=U(vwc,{Y9a:this.D,SJa:this.L});this.Ma.style.visibility="hidden"};
p.Sa=function(){wwc.ea.Sa.call(this);var a=this.cb("waffle-assistant-facet-toggle");this.va.pb(a);this.getHandler().R(this.Ma,"mousedown",this.Tg).R(this.va,"action",this.oIb);Mn&&(this.V=new swc("assistantAutovisFacetFeedback",this.xa()),this.V.render(this.cb("waffle-assistant-facet-feedback-container")),this.C=new fY(this.xa()),this.Xa(this.C),this.C.render(this.cb("waffle-assistant-facet-thumbs-container")),uwc(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().R(this.C,
"thumbs-up",this.d4b).R(this.C,"thumbs-down",this.c4b));xwc(this,iva)};p.Gd=g("$");p.$e=function(a){this.$=a;ywc(this)};p.Tg=function(a){a.stopPropagation()};p.oIb=function(){var a=iq(this.cb("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");xwc(this,a);zwc(this,a?2647:2646)};
function xwc(a,b){var c=a.cb("waffle-assistant-facet-toggle");nn(c,b?"HIDE":"SHOW");mq(a.cb("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);x(a.Zi("waffle-assistant-faceted-chart"),function(a){pn(a,b)});a.C&&N(a.C.Ma,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');eY(c,b?a:d)}
function Awc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function Bwc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function ywc(a){a.O&&!a.$&&x(a.Da,t(function(a){var b=a.Ma;if(!this.O.contains(b)){var d=this.O;a=new Cwc(b,a);wub(d,a)}},a))}p.d4b=function(){zwc(this,2649)};p.c4b=function(){zwc(this,2648);this.V.show(!0)};function zwc(a,b){var c=a.Kb,d=new BW,e=a.H.getChartType();d.C=e;e=a.H.Fd();d.F=e?e.clone():null;CW(c,b,d,10,a.H,a.H.jf())};function Dwc(){return W('<div class="waffle-assistant-card" tabindex="0" role="region">'+(Mn?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(Mn?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function gY(a,b){var c=this;P.call(this,b);this.D=a;this.$=this.V=this.O=null;this.hb=new OW(!0,"#4285f4");this.Xa(this.hb);this.kb=this.Mb=this.jc=!1;this.Qa=new jl(function(){c.Qa.stop();c.Ma.parentNode.querySelector(":hover")==c.Ma?c.Qa.start():c.BU()},100);this.Ca(this.Qa);this.Dd=this.Db=!1}u(gY,P);p=gY.prototype;p.gF=id;p.uca=jd;p.oH=kd;p.nH=kd;p.Gaa=kd;p.Xoa=kd;p.Woa=kd;p.$e=ca("Dd");p.Gd=g("Dd");p.Pqa=sa;p.Ha=function(){this.Ma=U(Dwc)};
p.Sa=function(){gY.ea.Sa.call(this);var a=this.cb("waffle-assistant-card-spinner-container");this.hb.render(a);Lo(this.cb("waffle-assistant-card-inner"),"visibility","hidden");if(this.gF()){a=this.Ma;var b=new vq(a);this.Ca(b);this.getHandler().R(b,"focusin",this.aqb).R(b,"focusout",this.$pb).R(a,"mouseenter",this.z2).R(a,"mouseleave",this.BU)}Ewc(this,!1);Mn&&(this.$=new swc(this.UC(),this.xa()),this.$.render(this.cb("waffle-assistant-card-feedback-container")),this.getHandler().R(this.$,"feedback-dialog-opened",
this.qvb).R(this,"trigger_feedback",this.a_b),this.uca()?(this.V=new fY(this.xa()),this.V.render(this.cb("waffle-assistant-thumbs-container")),Fwc(this,!0),a=db(this.Gaa()),Ra(a)||uwc(this.V,a),a=db(this.Xoa()),Ra(a)||eY(this.V.cb("waffle-assistant-thumbs-up-button"),a),a=db(this.Woa()),Ra(a)||eY(this.V.cb("waffle-assistant-thumbs-down-button"),a),this.getHandler().R(this.V,"thumbs-down",this.s4b).R(this.V,"thumbs-up",this.t4b)):Fwc(this,!1));this.bF()};
function hY(a){return a.cb("waffle-assistant-card-content-container")}function Gwc(a){a.gF();return a.cb("waffle-assistant-card-options")}function Fwc(a,b){Mn&&N(a.cb("waffle-assistant-thumbs-container"),a.uca()&&b)}p.wL=function(){this.isDisposed()||(this.jc=!0,Hwc(this))};function Iwc(a,b){!a.Mb&&b&&(a.Mb=!0,Hwc(a))}function Hwc(a){if(a.jc&&a.Mb){var b=t(a.r4b,a);a.hF(b)}}p.z2=function(){this.kb||(Ewc(this,!0),this.kb=!0,this.Qa.start())};p.BU=function(){Ewc(this,!1);this.kb=!1};
p.aqb=function(){Ewc(this,!0)};p.$pb=function(){var a=this,b=new jl(function(){ln(a.Ma,document.activeElement)||a.Ma.parentNode.querySelector(":hover")==a.Ma||Ewc(a,!1)},0);this.Ca(b);b.start()};p.s4b=function(){Jwc(this,!0);Fwc(this,!1);var a=this.nH();this.dispatchEvent(new bY("He",this,a))};p.t4b=function(){Fwc(this,!1);var a=this.oH();this.dispatchEvent(new bY("He",this,a))};p.qvb=function(){Jwc(this,!1)};p.a_b=function(){Jwc(this,!0)};
function Ewc(a,b){var c=a.cb("waffle-assistant-card-options");a=a.gF();N(c,a&&b)}p.r4b=function(){this.hb.setActive(!1);N(this.hb.Ma,!1);Lo(this.cb("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new G("content-rendered"))};function Jwc(a,b){mq(a.cb("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.$.show(b)};var Kwc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function Lwc(a){var b=new DE(nc(Kwc));return Vqc(a,b)}
function Mwc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.fc("useFirstColumnAsDomain")&&a.Fd()&&"number"===a.Fd().bd(0)&&a.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==a.fc("useFirstColumnAsDomain")&&a.Fd()&&"string"===a.Fd().bd(0)){c=0;var d=Xm("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.Fd().getNumberOfRows();b++)nn(d,a.Fd().Pf(b,0)),c=Math.max(c,jp(d).width);dn(d);c=Math.min(27,Math.max(15,10+100*c/271))}oQ()||Tn||(a.setOption("chartArea.top","15%"),b=a.fc("hAxis.title"),a.setOption("chartArea.height",Ra(db(b))?"80%":"65%"),a.setOption("chartArea.left",c+"%"),a.setOption("chartArea.width",
95-c+"%"),"PieChart"==a.getChartType()&&(a.setOption("chartArea.top",Ra(db(a.fc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10)));return a};function Nwc(a,b,c){var d=a.Nc(),e=a.Sc();switch(b){case 0:d=Math.min(d,a.vc()+c);break;case 1:e=Math.min(e,a.rc()+c)}return bh(a.Lb(),a.vc(),a.rc(),d,e)}function Owc(a){var b=new Ila;M(b,1,""+a.Zc);var c=a.rect.vc();M(b,2,c);c=a.rect.Nc();M(b,3,c);c=a.rect.rc();M(b,4,c);a=a.rect.Sc();M(b,5,a);return b}function Pwc(a){var b=new Zi;if(a){var c=new aj;a=Owc(a);Ri(c,7,a);Ri(b,58,c)}return b};function Qwc(){return W('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function Rwc(){return W(V(Ts({Ae:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:Jr(""+V(Xt({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+V(Ts({Ae:"waffle-assistant-zoom-button",content:Jr(""+V(Xt({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function iY(a,b,c,d,e,f,h){gY.call(this,a,h);this.C=B(a,8);this.Ic=b;this.yc=c;this.Kb=d;this.eb=e;this.Xc=f;this.L=new Us("",this.xa());this.Xa(this.L);this.va=new Us("",this.xa());this.Xa(this.va);this.qd=new ah;this.Xb=null;this.Ta=!1;this.Wb=[];this.Rb=[];this.qb=[];this.$a=this.Ja=this.F=this.H=this.Da=null;a=Pwc(this.Xc);this.J=ij(hj(new gj,10),a).build()}u(iY,gY);
var jY={I0a:"waffle-assistant-after-chart-preview",b1a:"waffle-assistant-before-chart-preview",l1a:"waffle-assistant-card-draggable",g7:"waffle-assistant-chart-highlights",N3a:"waffle-assistant-insert-chart-button",Dia:"waffle-assistant-chart-preview",K5a:"waffle-assistant-button-separator",j6a:"waffle-assistant-styled-border",k6a:"waffle-assistant-styled-rect",n7a:"waffle-assistant-zoom-button"};p=iY.prototype;p.hF=function(a){this.Xb=a;Swc(this)};
p.bF=function(){Twc(this,t(function(a){a=Yrc(this.Ic,a);uq(this.Ma,a)},this),!1)};p.gF=jd;p.UC=n("autovisFeedback");p.oH=n(2208);p.nH=n(2207);p.Gaa=n("Was this chart useful?");p.Ha=function(){iY.ea.Ha.call(this);hY(this).appendChild(U(Qwc));Gwc(this).appendChild(U(Rwc));uc(this.C,22)&&(this.F=new wwc(this.C,this.O,this.Kb,this.eb,this.xa()),this.Xa(this.F,!0),this.F.$e(this.Gd()))};
p.Sa=function(){iY.ea.Sa.call(this);T(this.Ma,jY.l1a);var a=this.cb(jY.N3a);this.L.pb(a);eY(a,"Insert chart");a=this.cb(jY.n7a);this.va.pb(a);eY(a,"View full size");a=this.cb(jY.b1a);var b=this.cb(jY.Dia),c=this.cb(jY.I0a);this.getHandler().R(this.Ma,"keydown",this.$3b).R(b,"click",this.Hqb).R(a,"focus",this.Fpb).R(c,"focus",this.vob).R(this.L,"action",this.Sxb).R(this.L.Ma,"mousedown",this.Tg).R(this.va,"action",this.YJb).R(this.va.Ma,"mousedown",this.Tg).R(this.cb(jY.g7),"mousedown",this.Tg).R(ww(this.Ic),
"Ea",this.a4b);Uwc(this);this.Kb.hc(2790,this.J);this.F&&this.Kb.hc(2791,this.J)};p.$e=function(a){iY.ea.$e.call(this,a);Uwc(this);this.gc()&&Vwc(this)};function Uwc(a){if(a.gc()){var b=a.Gd();a.L.setVisible(!b);a=a.xa().cb(jY.K5a,Gwc(a));N(a,!b)}}p.$3b=function(a){13==a.keyCode&&a.target==this.Ma&&(a.preventDefault(),a.stopPropagation(),Wwc(this,2255))};
function Xwc(a){var b=a.getChartType(),c=!!B(a.C,14),d=B(a.C,16),e=!!B(a.C,15),f="Histogram"==b;b="PieChart"==b;for(var h=qV(zc(a.D,4)),k=1<h.length,l=[],m=0;m<h.length;m++){var r=Ywc(h[m].rect,c!=b);Ib(l,r)}c=$z(a.yc).ld();var v=[];for(w in Ld)v.push(lhb(c,Ld[w]));var w=sb(l,function(a){return sb(v,Fa(ie,a))});f&&e&&(w=Jb(w,1));a.qb=Zwc(w.length,b&&0<d||!f&&!b&&e,b&&k);d=$z(a.yc);for(e=0;e<w.length;e++)for(f=a.qb[e],b=0;b<w[e].length;b++)w[e][b]&&ue(w[e][b])&&(k=Qmc(d,w[e][b],jY.k6a),a.Ca(k),TH(nJ(d),
k,!0),Lo(k.Ma,"background-color",f),k.setVisible(!0),a.Wb.push(k),k=SI(d,w[e][b],jY.j6a,1,0),a.Ca(k),mkb(k,f),k.setVisible(!0),a.Rb.push(k))}function $wc(a){Dc(a.Wb);Dc(a.Rb);a.Wb=[];a.Rb=[];a.qb=[]}p.a4b=function(){this.Ta&&($wc(this),Xwc(this))};p.z2=function(){iY.ea.z2.call(this);this.Ja=Ha();this.Ta||(Xwc(this),this.Ta=!0)};p.BU=function(){iY.ea.BU.call(this);pa(this.Ja)&&500<Ha()-this.Ja&&this.Kb.hc(2789,this.J);this.Ja=null;$wc(this);this.Ta=!1};p.Hqb=function(){this.Ma.focus()};
p.Fpb=function(){var a=this.cb(jY.g7);fp(a)?a.focus():this.Ma.nextSibling&&this.Ma.nextSibling.focus()};p.vob=function(){var a;if(a=this.$)a=this.$,a.Jb("waffle-assistant-feedback-card-hidden")?a=!1:(a.cb("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.va.Ma.focus()};p.Sxb=function(){Wwc(this,2255)};p.Tg=function(a){a.stopPropagation()};p.YJb=function(){R.r6.Bc(this,this.J)};p.Pqa=function(a,b){Wwc(this,2257,a,b)};
function Wwc(a,b,c,d){Twc(a,t(function(a){a=new owc(a,this.O,this.H&&this.H.Fd(),b,c,d,mma(this.J));this.dispatchEvent(a)},a),!1)}
p.b4b=function(a,b){if(b){var c=this.cb(jY.Dia);if(b.Ki())rE.fC(c,b);else{a.we(b.Fd());tW(a,a.Fd());hV(a,"ready",t(this.Z3b,this,a));b=[];try{var d=new sg;d.setContext(a.toJSON());var e=!!B(this.C,14);C(d,3,e);var f=B(this.C,16);C(d,4,f);C(d,5,"ROWS"==(e?"ROWS":"COLS"));C(d,8,0);if(B(this.C,24)){var h=B(this.C,25);C(d,9,h)}var k=qV(zc(this.D,4));for(e=0;e<k.length;e++)d.addRange(eh(k[e].rect,k[e].Zc));var l=this.qd.serialize(d);b=sb(Nsc(Fa(ritz_api.RitzModelApi.getVerbalHighlightsForProto,l),a).call(),
Ksc)}catch(m){b=[]}d=this.cb(jY.g7);N(d,0<b.length);0<b.length&&(d.appendChild(b[0]),pn(d,!0));this.H=a;GW(a,c,this.Kb,Tn)}}};p.Z3b=function(a){null!==this.Da&&(ci(ai(),this.Da),this.Da=null);this.isDisposed()||(a.jm()&&(sE(a.jm(),"onmouseover",t(this.X3b,this)),sE(a.jm(),"onmouseout",t(this.Y3b,this))),this.Xb(),Vwc(this))};p.X3b=function(){this.$a=Ha()};p.Y3b=function(){pa(this.$a)&&500<Ha()-this.$a&&this.Kb.hc(2795,this.J);this.$a=null};
function Vwc(a){if(a.eb&&!a.Gd()){var b=a.cb(jY.Dia);if(!a.eb.contains(b)){var c=a.eb;a=new Cwc(b,a);wub(c,a)}}}function axc(a){a.Db&&(a.Da=bi(ai(),hk.iza),a.Db=!1);B(a.C,16);var b=Lwc(a.C);b.nfa(UE);var c=Xqc(a.D);b.ai(c.toString());a.F&&(c=c.clone(),a.F.F=c);return b}
function Swc(a){var b=axc(a);b=Mwc(b,a.cb("waffle-assistant-card-inner"));(new ZV(UE,b.jf())).send(t(a.b4b,a,b));a.F&&Twc(a,t(function(a){var c=this.F,e=b;a=new DE(a.toJSON());e=new DE(e.toJSON());var f=c.Zi("waffle-assistant-faceted-chart");if(1<f.length){Bwc(a);var h=e;Awc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");oQ()||Tn||h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,Bwc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),Awc(e);h=qV(zc(c.J,27));T5a(c.F,h);h=B(c.J,25);for(var k=0;k<f.length;k++){var l=na(c.L[k])?c.L[k]:null,m=h.clone(),r=c.Ja,v=new xg;C(v,1,r);na(l)&&v.ib(l);C(m,7,v);c.F.Sb("dt",encodeURIComponent(JSON.stringify(c.qd.serialize(m))));
r=new DE(a.toJSON());r.ai(c.F.toString());m=e.clone();m.ai(c.F.toString());var w=c,y=r.fc("title");y||(y=Ovc(r));v=y+(' when "'+(w.D+('" is "'+(l+'"'))));w=y+(' by "'+(w.D+'"'));v=l?v:w;r.setOption("title",v);m.setOption("title",v);w=new qwc(r,m,0,0,c.Qa,c.Kb,c.xa());c.Xa(w);v=f[k];w.pb(v);c.Da.push(w);w=c;y=Ovc(r);r=y+(' broken down by "'+(w.D+('" for "'+(l+'"'))));w=y+(' broken down by "'+(w.D+'"'));uq(v,l?r:w);c.H=m}ywc(c);c.Ma.style.visibility="visible"},a),!1)}
function Twc(a,b,c){var d=axc(a);(new ZV(UE,d.jf())).send(function(a){a?(a=a.Fd(),c&&d.we(a),tW(d,a),b(d)):b(null)})}p.getChartType=function(){return this.C.getChartType()};function Zwc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=Mpc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Ib(d,d);return d}function Ywc(a,b){return b?anc(a,new Wd(a.width,1)):anc(a,new Wd(1,a.height))};function Cwc(a){xK.apply(this,arguments)}ha(Cwc,xK);Cwc.prototype.kpa=g("element");function bxc(){vK.call(this);this.Ta.push(this);this.Da=this.Ja=!0;this.kb="waffle-assistant-dragged-card"}u(bxc,vub);bxc.prototype.contains=function(a){return!!x(this.L,function(b){if(b.element==a)return!0})};bxc.prototype.ipa=function(a){var b=bxc.ea.ipa.call(this,a);if(oQ()||Tn){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=sb(b.querySelectorAll("clippath"),function(a){return a.id}),cxc(b,a);return b};
function cxc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];na(c)&&Ya(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=fn(a);for(c=0;c<a.length;c++)cxc(a[c],b)};function dxc(){return W('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function kY(a,b){gY.call(this,a,b);this.C=B(a,8)}u(kY,gY);p=kY.prototype;p.bF=sa;p.UC=n("assistantWordCloudFeedback");p.oH=n(2634);p.nH=n(2633);p.Ha=function(){kY.ea.Ha.call(this);hY(this).appendChild(U(dxc));T(hY(this),"waffle-assistant-word-cloud-content-container")};
p.hF=function(a){for(var b=zc(this.C,19),c=zc(this.C,20),d=this.cb("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(exc(this,b,c,e),120<d.clientHeight){exc(this,b,c,e-1);break}b=this.xa();c=B(this.C,2);c=zn(b,c);d=this.cb("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function exc(a,b,c,d){var e=a.cb("waffle-assistant-word-cloud-words-container");for(a=a.xa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){k&&e.appendChild(zn(a," "));var l=a.createElement("SPAN");a.appendChild(l,zn(a,b[k]));a.appendChild(e,l);T(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=k%2?"#61443C":"#00695C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function fxc(a){return W('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+X(a.iconSize)+'px" width="'+X(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+X(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function gxc(){var a=W;var b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+V(fxc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=W(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function hxc(a){return W('<div class="waffle-assistant-panel-title-bar">'+V(Ts({Ae:"waffle-assistant-panel-back-button",content:Jr(""+V(Xt({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+V(a.title)+"</div></div>")};function lY(a){P.call(this,a);this.Xb=new OW(!1,"#4285f4");this.Xa(this.Xb);this.J=new P(this.xa());this.Xa(this.J);this.C=[];this.Kd=this.Ze=!1;this.Ic=this.yc=this.eb=this.O=null;this.Mb=new Us("",a,4);zr(this.Mb,2,!1);this.Xa(this.Mb)}u(lY,P);var ixc={defaultHelpArticleId:"6280499"};p=lY.prototype;p.Ha=function(){lY.ea.Ha.call(this);this.Ma=U(gxc);this.yc=this.cb("waffle-assistant-panel-content-container");this.Ic=this.cb("waffle-assistant-empty-list")};
p.Sa=function(){lY.ea.Sa.call(this);var a=this.cb("waffle-assistant-spinner-container");this.Xb.render(a);this.J.pb(this.cb("waffle-assistant-panel-card-holder"));this.Mb.pb(this.cb("waffle-assistant-empty-list-learn-more"));this.getHandler().R(this.Mb,"action",this.u4b).R(this.Ma,"scroll",noc(this.Jga,10,this))};p.setVisible=function(a){var b=this;N(this.Ma,a);x(this.C,function(a){if(!a.gc()){var c=b.J.jd();a.O=c;b.J.Xa(a,!0);a.wL()}});this.Ze=a};
p.yva=function(a,b){var c=this.xa();this.O&&this.H9();this.O=new P;this.Xa(this.O);a=fr(a,hxc,{title:b});this.eb=new Us("",this.xa());this.O.Xa(this.eb);this.eb.pb(c.cb("waffle-assistant-panel-back-button",a));eY(this.eb.Ma,"Back");this.O.getHandler().R(this.eb,"action",this.wpb)};p.H9=function(){this.O.dispose();this.O=null};function jxc(a,b){a.Xb.setActive(b);N(a.cb("waffle-assistant-panel-pane"),!b)}p.gJ=function(a){N(this.Ic,a);N(this.yc,!a)};
function kxc(a,b){Eb(a.C,b);a.J.removeChild(b);a.J.Lh(b,0);a.C.push(b)}p.TI=function(a){Eb(this.C,a);-1!=tp(this.J,a)&&this.J.removeChild(a,!0)};p.L_=function(){this.J.Ld(!0);Dc(this.C);this.C=[]};p.Jga=function(){var a=this.Ma;a=a.scrollTop+cp(a).height;for(var b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(Iwc(d,!0),b+=cp(d.Ma).height):Iwc(d,!1)}};p.$e=function(a){this.Kd=a;x(this.C,function(b){b.$e(a)})};p.Gd=g("Kd");p.u4b=function(){Q.So.Bc(ixc)};p.wpb=function(){this.dispatchEvent("ze")};function lxc(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+V(a.title)+"</div>"+V(Ts({Ae:"waffle-assistant-section-more-button",content:Jr("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return W(a)};function mY(a,b,c,d){P.call(this,d);this.V=a;this.hb=b;this.$=new Us("",this.xa());this.Xa(this.$);this.J=new P(this.xa());this.Xa(this.J);this.C=null;this.eb=[];this.$a=this.Ta=!1;this.Kb=c}u(mY,P);p=mY.prototype;p.IQa=id;p.Dwa=jd;p.Ha=function(){mY.ea.Ha.call(this);this.Ma=U(lxc,{title:this.pX()})};
p.Sa=function(){mY.ea.Sa.call(this);this.J.pb(this.cb("waffle-assistant-section-card-holder"));this.$.pb(this.cb("waffle-assistant-section-more-button"));this.getHandler().R(this.$,"action",this.mAb);this.C=this.AGa();this.Ca(this.C);N(mxc(this),this.IQa());this.setVisible(!1)};p.setVisible=function(a){if(this.gc()&&this.mb()!=a&&(N(this.Ma,a),a)){N(this.$.Ma,this.sYa());a=new aj;M(a,4,this.Iga());var b=new Zi;Ri(b,58,a);a=ij(hj(new gj,10),b).build();this.Kb.hc(2774,a)}};
p.mb=function(){return this.gc()&&fp(this.Ma)};p.sYa=function(){return this.eb.length>this.V};p.AGa=function(){return new lY(this.xa())};p.$e=function(a){this.$a=a;x(nxc(this),function(b){b.$e(a)});this.C.$e(a)};p.Gd=g("$a");p.dg=sa;
p.a6=function(a){this.eb=a;for(var b=0;b<a.length;b++){if(this.J.jd()<this.V){var c=this.W_(a[b]);c.$e(this.$a);var d=this.J.jd();c.O=d;this.J.Xa(c,!0)}if(this.Dwa()&&(this.C.gJ(!1),c=this.C,d=this.W_(a[b]),c.C.push(d),c.Ze)){jxc(c,!1);var e=c.J.jd();d.O=e;c.J.Xa(d,!0);d.wL()}}};function nxc(a){var b=[];a.J.Zf(function(a){b.push(a)});return b}function mxc(a){return a.cb("waffle-assistant-section-content")}p.Nra=function(){return this.J.oca()};
p.oX=function(){this.eb=[];Dc(this.J.Ld(!0));this.setVisible(!1);this.Dwa()&&(this.C.L_(),this.C.gJ(!0))};function oxc(a){a.J.Zf(function(a,c){c<this.V&&a.wL()},a)}p.b6=function(a){var b=0;if(this.Ta)this.C.Jga();else if(this.Nra()){this.setVisible(!0);b=cp(this.cb("waffle-assistant-section-header")).height+cp(mxc(this)).height;for(var c=nxc(this),d=0;d<c.length;d++)b<a&&d<this.V?(this.UNa(c[d]),Iwc(c[d],!0),b+=cp(c[d].Ma).height):Iwc(c[d],!1)}else this.setVisible(!1);return a-b};p.UNa=sa;
p.setActive=function(a){(this.Ta=a)||this.C.H9()};p.dc=g("Ta");function pxc(a,b){a.C.yva(b,a.pX())}p.mAb=function(){this.setActive(!0);this.dispatchEvent("Ee")};p.bt=g("Kb");function nY(a,b,c,d,e){mY.call(this,20,d,c,e);this.va=a;this.L=b;this.D=new bxc;this.Ca(this.D);this.F=null;this.H=0;this.O=null}u(nY,mY);p=nY.prototype;p.Sa=function(){nY.ea.Sa.call(this);this.D.Ke();this.getHandler().R(this.D,"drag",this.W3b).R(this.D,"dragend",this.Ym)};p.pX=n("Analysis");p.U8=function(a){return 0==a};p.W_=function(a){return"WordCloud"==B(a,8).getChartType()?new kY(a,this.xa()):new iY(a,this.va,this.L,this.bt(),this.D,this.O,this.xa())};
p.$e=function(a){nY.ea.$e.call(this,a);a&&qub(this.D)};p.UNa=function(a){this.getHandler().Kc(a,"content-rendered",this.V3b);this.H++};p.a6=function(a,b){this.O=b||null;nY.ea.a6.call(this,a,b)};p.V3b=function(){--this.H||this.dispatchEvent("Be")};p.W3b=function(){this.F=Zo(this.D.hd.target)};p.Ym=function(a){var b=this.F,c=$z(this.L).qe();if(ae(cH(c,"page",!1,!1)).contains(b)){var d=aH(c,b.x,b.y,"page");c=eH(c,fe(d),"page");b=new Pd(b.x-c.left,b.y-c.top);a.C.getData().Pqa(d,b)}this.F=null};
p.Iga=n(2);function qxc(a){var b=[];if(uc(a,25)&&(a=B(a,25)))for(var c=0;c<vc(a,1);c++){var d=B(a,1,c);if(uc(d,2)){var e=B(d,2);e&&b.push(rxc(e,sxc(d)))}}return b}function txc(a){var b=qxc(a);uc(a,6)&&(a=B(a,6))&&b.push(rxc(a,0));return b}function sxc(a){return(a=uc(a,4)?B(a,4):0)?a:0}function rxc(a,b){return{name:a,O7a:b}};function uxc(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function oY(a){return uxc(a,1)[0]}function vxc(a){var b=0;x(a,function(c,d){c.length>a[b].length&&(b=d)});return sb(a[b],function(b,d){return sb(a,function(a){return a[d]})})}
function wxc(a){var b={};x(a,function(a){b[a]||(b[a]=0);b[a]++});Kb(a);Ob(a,function(a,d){return b[d]-b[a]})};function xxc(a,b,c){this.Da=a;this.Ja=b;this.L=[];this.O=[];this.H=[];this.J=[];this.$=[];this.va=[];this.C=new Dd;this.F=new Dd;this.V=new Dd;this.D=new Dd;yxc(this,c)}function zxc(a,b){return Ed(a,b)?a.get(b).values.od():[]}
function yxc(a,b){for(var c=new Id,d=new Id,e=0;e<b.length;e++){for(var f=txc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(Ed(a.Da,m)){var r=a.Da.get(m);c.add(r);h.push(r)}Ed(a.Ja,m)&&(m=a.Ja.get(m),d.add(m),k.push(m))}Axc(a,h,k)}a.L=c.od();a.O=d.od();Ob(a.L);Ob(a.O);a.H=sb(a.C.od(),function(a){return a.key});Ob(a.H);a.J=sb(a.F.od(),function(a){return a.key});Ob(a.J);a.$=sb(a.V.od(),function(a){return a.key});Ob(a.$);a.va=sb(a.D.od(),function(a){return a.key});Ob(a.va)}
function Axc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)pY(a.C,b[d],b[e]),pY(a.C,b[e],b[d]);for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)pY(a.F,b[d],c[e]),pY(a.V,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)pY(a.D,c[b],c[d]),pY(a.D,c[d],c[b])}function pY(a,b,c){var d;Ed(a,b)?d=a.get(b).values:d=new Id;d.add(c);a.set(b,{key:b,values:d})};function Bxc(a,b){this.C=a;for(var c=new Dd,d=0;d<a.pk();d++)c.set(a.Id(d).getName().toLowerCase(),d);this.F=c;c=new Dd;for(d=0;d<vc(a,1);d++)c.set(B(a,1,d).getName().toLowerCase(),d);this.V=c;c={};for(d=0;d<a.pk();d++){var e=a.Id(d);c[B(e,11)]=e}this.Da=c;c={};for(d=0;d<vc(a,1);d++)e=B(a,1,d),c[B(e,4)]=e;this.Ja=c;c=[];for(d=0;d<a.pk();d++)qY(a.Id(d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<vc(a,1);d++)qY(B(a,1,d).getName())&&c.push(d);this.O=c;c=[];for(d=0;d<vc(a,1);d++){e=B(a,1,d).getName();
for(var f=!0,h=0;h<Cxc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+Cxc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Qa=c;this.$a=Dxc(a,0);this.$=Dxc(a,1);c=[];for(d=0;d<a.pk();d++).8<=B(a.Id(d),6)&&c.push(d);this.va=c;c=[];for(d=0;d<a.pk();d++)e=a.Id(d),.95<=zc(e,2).length/B(e,8)&&c.push(d);this.eb=c;c=[];for(d=0;d<vc(a,3);d++){e=a.Id(B(a,3,d));a:if(.5<zc(e,2).length/B(e,8)||.3>vc(e,3)/vc(e,2))e=!1;else{for(f=0;f<vc(e,10);f++)if(.95<B(e,10,f)/B(e,8)){e=!1;break a}e=!0}e&&c.push(B(a,3,d))}Ob(c);
this.Ta=c;this.H=Exc(a.pk());this.J=Exc(vc(a,1));this.D=new xxc(this.F,this.V,b)}function Exc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function Dxc(a,b){for(var c=[],d=0;d<a.pk();d++)a.Id(d).getType()==b&&c.push(d);return c}function Fxc(a,b){if(!a.length&&!b.length)return[];for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=Gxc(c,a[d]);for(a=0;a<b.length;a++)d=Gxc(c,b[a]),c=0<d.length?d:c;return c}
function rY(a,b,c,d,e,f,h,k){var l=[a.L,a.D.L],m=[a.H];c&&(m.push(a.$a),m.push(a.va));d&&m.push(a.Ta);e&&m.push(a.eb);null!=h&&-1!=h?l.push(zxc(a.D.F,h)):f&&l.push(a.D.J);k&&l.push(a.D.H);c=Fxc(m,l);return 0<b.length&&(b=b[0].getName())&&(a=a.F.get(b.toLowerCase(),-1),c.includes(a))?a:0<c.length?c[oY(c.length)]:-1}
function sY(a,b,c,d,e,f){var h=[a.O,a.D.O],k=[a.J];c&&k.push(a.Qa);null!=e&&-1!=e?h.push(zxc(a.D.V,e)):d&&h.push(a.D.$);f&&h.push(a.D.va);c=Fxc(k,h);return 0<b.length&&(b=b[0].getName())&&(a=a.V.get(b.toLowerCase(),-1),c.includes(a))?a:0<c.length?c[oY(c.length)]:-1}function Hxc(a,b){for(var c=5;;){var d=a.C.Id(b),e=oY(vc(d,2));c--;if(qY(RX(d,e))||!c)return e}}function Ixc(a,b){for(var c=5;;){var d=a.C.Id(b),e=oY(vc(d,3));e=B(d,3,e);c--;if(qY(RX(d,e))||!c)return e}}
function tY(a,b){b=a.C.Id(b);a=b.getName();qY(a)||(b=Jxc(zc(b,7)),a=null==b?a:b);return a}function uY(a,b){b=B(a.C,1,b);a=b.getName();qY(a)||(b=Jxc(zc(b,2)),a=null==b?a:b);return a}function Jxc(a){for(var b=0;b<a.length;b++)if(qY(a[b]))return a[b];return null}function qY(a){return null==a?!1:50>=a.length}function Kxc(a){for(var b=uxc(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}
function Gxc(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var Cxc=["average","total","sum","mean","median"];function vY(a){this.Ta=a;this.oB=[];this.C=this.Da=this.va=this.aO=this.kJ=null;this.V=[];this.O=new Id;this.Ja=new Id;this.$=!1;this.F=[];this.D=[]}p=vY.prototype;p.Ke=function(a,b,c,d,e){this.reset();this.kJ=b;this.aO=c;this.va=d;this.Da=a;this.V=cva?e:[];this.C=new Bxc(a,e)};
p.Qda=function(){if(this.$){var a=rw(mw(this.Ta)),b=Ac(this.C.C,4)?a.top:a.left;a=this.C.Da[b];b=this.C.Ja[b];a&&Ab(this.F,a);b&&Ab(this.D,b)}a=[];if(cva)for(b=0;b<this.V.length;b++){var c=this.V[b];switch(c.getChartType()){case "BarChart":if(this.Wl(13)||this.Wl(2)){var d=B(c,6);d&&-1!=this.C.F.get(d.toLowerCase(),-1)&&(d=Lxc(this,c),1<d.length&&(Rn&&this.Wl(23)?wY(this,a,"Scatter chart of "+d[0].name+" vs "+d[1].name,23,2):this.Wl(2)&&wY(this,a,"Correlation of "+d[0].name+" and "+d[1].name,2,1.5)))}break;
case "ScatterChart":d=Lxc(this,c);1<d.length&&(Rn&&this.Wl(23)?wY(this,a,"Scatter chart of "+d[0].name+" vs "+d[1].name,23,2):this.Wl(2)&&wY(this,a,"Correlation of "+d[0].name+" and "+d[1].name,2,1.5));break;case "PieChart":d=[];c=qxc(c);for(var e=0;e<c.length&&-1!=this.C.F.get(c[e].name.toLowerCase(),-1);e++)d.push(c[e]);1==d.length&&4==d[0].O7a&&(Rn&&this.Wl(20)?wY(this,a,"Chart of distribution of "+d[0].name,20,2):this.Wl(14)&&wY(this,a,"Distribution of "+d[0].name,14,1.5))}}this.Wl(1)&&(d=this.C.C,
b=sY(this.C,this.D,!1,!0),c=rY(this.C,this.F,!0,!1,!0,!0,b),-1!=c&&-1!=b&&(d=10<=vc(d.Id(c),2)?"5 ":"",c=tY(this.C,c),b=uY(this.C,b),c!=b&&wY(this,a,this.ZLa(1)+" "+d+c+" by "+b,1)));if(this.Wl(2)&&1<vc(this.C.C,1)){a:if(d=this.C,2>d.J.length)b=[-1,-1];else{c=sY(d,this.D,!1,!1,void 0,!0);if(-1!=c&&(b=zxc(d.D.D,c),0<b.length)){d=[c];c=oY(b.length);d.push(b[c]);b=d;break a}b=Kxc(2<=d.O.length?d.O:d.J)}d=b;b=uY(this.C,d[0]);d=uY(this.C,d[1]);b!=d&&wY(this,a,"Correlation of "+b+" and "+d,2)}this.Wl(3)&&
(b=this.C.C,d=sY(this.C,this.D,!0),-1!=d&&wY(this,a,this.lT(zc(B(b,1,d),3),3)+" of "+uY(this.C,d),3));if(this.Wl(5)){b=this.C.C;d=sY(this.C,this.D,!0,!0);var f=rY(this.C,this.F,!0,!0,!1,!0,d);if(-1!=d&&-1!=f){c=uY(this.C,d);e=b.Id(f);var h=tY(this.C,f);0<vc(e,3)&&h!=c&&(f=Ixc(this.C,f),wY(this,a,this.lT(zc(B(b,1,d),3),5)+" of "+c+" when "+h+" is "+RX(e,f),5))}}this.Wl(9)&&(d=sY(this.C,this.D,!1,!0),b=rY(this.C,this.F,!0,!1,!0,!0,d),-1!=b&&-1!=d&&(d=uY(this.C,d),b=tY(this.C,b),b!=d&&wY(this,a,b+" with "+
this.Hoa(9)+" "+d,9)));this.Wl(10)&&0<vc(this.C.C,1)&&(b=uY(this.C,sY(this.C,this.D)),wY(this,a,this.Hoa(10)+" "+b,10));this.Wl(11)&&(b=this.C.C,d=rY(this.C,this.F,!0,!0,!1,!1,-1),-1!=d&&(c=tY(this.C,d),0<vc(b.Id(d),3)&&wY(this,a,"Most frequent "+c,11)));if(this.Wl(12)){b=this.C.C;d=sY(this.C,this.D,!0);a:{c=this.C;if(1==c.$.length&&(e=c.$[0],!B(c.C.Id(e),5))){c=e;break a}c=-1}h=c;-1!=h&&-1!=d&&(c=uY(this.C,d),e=b.Id(h),0<vc(e,2)&&(h=Hxc(this.C,h),wY(this,a,this.lT(zc(B(b,1,d),3),12)+" of "+c+" "+
Mxc[oY(Mxc.length)]+" "+RX(e,h),12)))}this.Wl(15)&&(b=this.C.C,d=sY(this.C,this.D,!0),h=rY(this.C,this.F,!1,!0,!1,!0,d),-1!=d&&-1!=h&&(c=uY(this.C,d),e=tY(this.C,h),e!=c&&(h=b.Id(h),2<=vc(h,3)&&(f=uxc(vc(h,3),2),wY(this,a,"Compare "+this.lT(zc(B(b,1,d),3),15)+" "+c+" for "+e+" "+RX(h,B(h,3,f[0]))+" and "+RX(h,B(h,3,f[1])),15)))));this.Wl(16)&&(b=rY(this.C,this.F,!0,!0,!1,!1),-1!=b&&(b=tY(this.C,b),wY(this,a,"List unique values in "+b,16)));this.Wl(17)&&(d=this.C.C,b=rY(this.C,this.F,!0,!0,!1,!1),
-1!=b&&(d=d.Id(b),c=tY(this.C,b),1>vc(d,3)||(b=Ixc(this.C,b),wY(this,a,"What percentage of "+c+" is "+RX(d,b),17))));this.Wl(13)&&(b=this.C.C,d=sY(this.C,this.D,!0,!0),e=rY(this.C,this.F,!0,!0,!1,!0,d),-1!=d&&-1!=e&&(c=uY(this.C,d),e=tY(this.C,e),e!=c&&wY(this,a,this.lT(zc(B(b,1,d),3),13)+" of "+c+" by "+e,13)));Rn&&this.Wl(18)&&(b=sY(this.C,this.D),-1!=b&&wY(this,a,"Histogram of "+uY(this.C,b),18,2));!(b=3>a.length)&&oY(5)||!this.Wl(7)||(c=this.C.C,h=sY(this.C,this.D,!1,!0),d=rY(this.C,this.F,!1,
!1,!1,!0,h),-1!=d&&-1!=h&&(c=c.Id(d),e=tY(this.C,d),h=uY(this.C,h),0<vc(c,2)&&e!=h&&(d=Hxc(this.C,d),wY(this,a,"Show "+h+" for "+e+" "+RX(c,d),7))));if((b||!oY(5))&&this.Wl(8)){b=this.C.C;a:if(e=this.C,2>e.H.length)d=[-1,-1];else{c=rY(e,this.F,!0,!1,!1,!1,void 0,!0);if(-1!=c&&(d=zxc(e.D.C,c),0<d.length)){c=[c];e=oY(d.length);c.push(d[e]);d=c;break a}d=Kxc(2<=e.L.length?e.L:e.H);d[0]!=c&&(d[1]=d[0],d[0]=c)}c=d;d=c[0];1<b.pk()&&-1!=d&&(c=c[1],b=b.Id(c),e=tY(this.C,c),d=tY(this.C,d),0<vc(b,2)&&e!=d&&
(c=Hxc(this.C,c),wY(this,a,"What is "+d+" where "+e+" is "+RX(b,c),8)))}this.oB=Nxc(a)};p.reset=function(){this.oB=[];this.D=[];this.F=[];this.Ja=new Id;this.O=new Id};p.Rda=function(){return pj(this.oB.slice())};function Nxc(a){Ob(a,function(a,c){return c.weight-a.weight});return sb(a,function(a){return a.mxa})}function wY(a,b,c,d,e){e=a.XLa(d,void 0===e?1:e);a.Ja.contains(c)||(b.push({mxa:{query:c,ep:void 0,type:d},weight:e}),a.O.add(d),a.Ja.add(c))}p.Wl=function(a){return!this.O.contains(a)};
function Oxc(a,b){return a.Rda().then(function(a){return a.length<=b?a:Jb(a,0,b)},null,a)}function Lxc(a,b){var c=[];b=qxc(b);for(var d=0;d<b.length&&-1!=a.C.V.get(b[d].name.toLowerCase(),-1);d++)c.push(b[d]);return c}p.lT=function(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=Pxc;break a;case 4:a=Qxc;break a}a=Rxc}return a[oY(a.length)]};p.ZLa=function(){return Sxc[oY(Sxc.length)]};p.Hoa=function(){return Txc[oY(Txc.length)]};
var Rxc=["Average","Median"],Pxc=["Total","Average","Median"],Qxc=["Median"],Txc="Minimum Maximum Most Least Highest Lowest".split(" "),Sxc=["Top","Bottom"],Mxc=["before","after"];function Uxc(a,b,c){vY.call(this,a);this.J=[];this.L=this.H=null;this.Qa=b;this.Kb=c;this.$a=hj(new gj,10).build()}ha(Uxc,vY);p=Uxc.prototype;p.Qda=function(){this.reset();vY.prototype.Qda.call(this);bva&&Vxc(this)};p.reset=function(){vY.prototype.reset.call(this);this.J=[];this.H&&(this.H.cancel(),this.H=null)};p.Rda=function(){return bva&&this.H?this.H.then(function(){return this.J.slice()},null,this):vY.prototype.Rda.call(this)};p.XLa=function(a,b){return Math.pow(Math.random(),1/(Wxc(a)*b))};
p.dg=ca("L");function Wxc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;default:return.3}}
function Vxc(a){var b=null;a.H=new nj(function(a){if(!this.L||3<=this.L.getStatus().getState().C)this.J=this.oB,a();var c=$w(this.kJ.rect),e=sb(this.oB,function(a){return a.query});c=Bl(Al(Bk(Dk(Ek(this.L.zf("/answers/parsesuggestions").Yf("gid",this.kJ.Zc,"range",c),t(function(b){Xxc(this,b).then(a)},this)),t(function(b){8==b.errorCode&&this.Kb.hc(2833,this.$a);this.J=this.oB;a()},this)).setContent(["queries",ul(e)]).setTimeout(2E3),1)),"POST");Xn&&this.aO&&null!=this.va&&(e=this.aO.rect.width&&
this.aO.rect.height?$w(this.aO.rect):"",c.Yf("headerRange",e,"tableRecordDimension",""+this.va));b=c.Re()},a);uj(a.H,function(){b&&b.dispose()})}function Xxc(a,b){return a.Qa.C.D.Yd.then(function(){var a=[];if(b.Tl())for(var d=b.Lf(),e=0;e<d.length;e++){var f;if(f=d[e])f=!!this.Da&&!!B(this.Da,4),f=Yxc(this.Qa,d[e],this.kJ,f),f=Zxc(f);f&&(this.oB[e].ep=d[e],a.push(this.oB[e]))}this.J=a},function(){this.J.length=0},a)};var $xc={};Wb({N6a:{type:0,qB:"",mB:[]},SUM:{type:1,qB:"Sum",mB:[3,5,13,12,15]},AVERAGE:{type:2,qB:"Average",mB:[3,5,13,12,15]},fia:{type:3,qB:"Mode",mB:[3]},a7a:{type:4,qB:"Variance",mB:[3]},g6a:{type:5,qB:"Standard deviation",mB:[3]},MEDIAN:{type:6,qB:"Median",mB:[3,5,13,12]},COUNT:{type:7,qB:"Count",mB:[]},c6a:{type:8,qB:"Bottom",mB:[1,10,14]},d6a:{type:9,qB:"Top",mB:[1,11,10,14]}},function(a){$xc[a.type]=a});function ayc(a){if(a=$xc[a])return a};function byc(a){vY.call(this,a);this.H=[]}ha(byc,vY);p=byc.prototype;p.reset=function(){vY.prototype.reset.call(this);this.H=[]};p.XLa=n(1);p.Wl=function(a){return!this.O.contains(a)&&0<cyc(this,a).length};p.ZLa=function(a){return dyc(this,a)};p.lT=function(a,b){return dyc(this,b)};p.Hoa=function(a){return dyc(this,a)};function eyc(a,b){a.reset();x(b,function(b){x(zc(b,1),function(b){a.H.push(B(b,1))},a)},a);wxc(a.H);a.Qda();return Oxc(a,3)}
function cyc(a,b){return rb(a.H,function(a){return yb(ayc(a).mB,b)},a)}function fyc(a,b){a=wb(a.H,function(a){return ayc(a).type==b},a);return ayc(a)}function dyc(a,b){b=cyc(a,b);return fyc(a,b[oY(b.length)]).qB};var gyc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),hyc=[{nk:["Thank you","Thankyou","Thanks"],Ug:"No problem"},{nk:["you are amazing","This is great","omg"],Ug:"Happy to help"},{nk:["I love you"],Ug:"Must be in the air"},{nk:["How do you know","How are you so smart"],Ug:"It's all in the data"},{nk:["Are you sure"],Ug:"Send feedback if this doesn't seem correct to help improve accuracy"},{nk:["How are you"],Ug:"Pretty good, thanks"},
{nk:["Hi","Hello","Hey"],Ug:"Hi, there. Try asking a question about your data."},{nk:["You are stupid","This is dumb","You are wrong"],Ug:"Help improve this experience by sending feedback"},{nk:["How smart are you"],Ug:"Pretty smart"}];function iyc(a){for(var b=0;b<hyc.length;++b)if(-1!=xb(hyc[b].nk,function(b){return Ma(a,b)}))return b;return-1};function jyc(a,b,c,d){var e=new Tvc;M(e,2,c);x(b,function(a){Mi(e,1).push(a)});M(e,3,d);d=new SX;M(d,1,a);M(d,3,b[c]);Ri(d,11,e);return d}function kyc(a,b,c,d){var e=new Vvc;M(e,2,c);x(b,function(a){Mi(e,1).push(a)});M(e,3,d);d=new SX;M(d,1,a);M(d,2,b[c]);Ri(d,10,e);return d}function lyc(a){var b=new Wvc;x(a,function(a){var c=a.type;Mi(b,1).push(c);a.tKa&&(a=a.tKa,Mi(b,2).push(a))});return b}function myc(a){var b=new Uvc;x(a,function(a){a=a.type;Mi(b,1).push(a)});return b}
function nyc(a,b,c,d){var e=new Svc;a&&M(e,1,a);b&&M(e,2,b);for(a=0;a<c.length;a++)b=c[a],Mi(e,3).push(b);M(e,4,d);return e};function xY(a,b){this.D=a;this.C=b}xY.prototype.getChartType=g("D");var yY={2:new xY("ColumnChart","Column chart"),3:new xY("LineChart","Time series"),4:new xY("ScatterChart","Scatter chart"),5:new xY("PieChart","Pie chart"),10:new xY("Histogram","Histogram"),7:new xY("LineChart","Line chart")};function zY(a,b,c,d,e,f,h){this.D=a;this.j_=b;this.H=(void 0===h?null:h)||b;this.C=d;this.ep=c;this.Qa=d?zc(d,6):[];this.Ta=d?zc(d,7):[];this.Ja=d?zc(d,8):[];this.error=e||1;this.interpretation=d&&uc(d,4)?B(d,4):null;this.O=d?zc(d,12):[];this.Da=d?zc(d,21):[];this.va=f;this.F=null;this.$=this.J=!1;this.L=[];this.V=null;Rn&&oyc(this)}function pyc(a){return 1==a.error&&null!=a.ep}
function qyc(a){return{GO:ryc(a),interpretation:a.interpretation,j_:a.j_,ep:a.ep,q3:1<a.j_.length&&1<a.j_[0].length,Ol:a.Ol(),sYb:a.$,J2:a.J2(),dLb:a.L}}zY.prototype.Ol=function(){return Rn&&null!=this.F&&(this.F in yY?!0:!1)&&2<this.H.length};zY.prototype.J2=function(){return Qn&&Qh(I(),"feapt")&&null!==this.C&&uc(this.C,24)};zY.prototype.getChartType=function(){if(!this.Ol())return null;var a=this.F;if(a in yY)return yY[a].getChartType();throw Error("Unknown chart type.");};
function syc(a){a.Ol();return a.H[0][0]}function tyc(a){return sb(zc(a.C,22),function(b){if(B(b,2)){var c=a.va.C;return Yw(B(b,2),c)}},a)}function uyc(a){return{GO:ryc(a),error:vyc(a)}}function wyc(a,b,c){var d=c.length;if(!d)return a;1<d&&Eb(a,10);c=B(c[0],1);2<d&&9==c&&Eb(a,4);2<d&&Eb(a,5);2!=c&&3!=c&&12!=c&&Eb(a,3);yb(b,10)&&yb(a,10)&&Vaa(a,function(a){return 10!=a});return a}
function oyc(a){var b=null;a.J=!1;a.F=null;if(a.C&&uc(a.C,17)){var c=B(a.C,17);a.$=B(c,4)||!1;var d=zc(c,3),e=wyc(zc(c,1),d,zc(a.C,18));0<d.length&&(!e.length||1>=a.H.length||1>a.H[0].length)?a.L.push("Charts for this question are not supported."):(0<d.length?(b=rb(e,function(a){return yb(d,a)}),c=rb(d,function(a){return!yb(e,a)}),Eb(c,6),0<b.length?(a.J=!0,a.F=b[0],b=a.F):yb(d,10)&&yb(e,2)?(a.J=!0,a.F=2,Eb(c,10),b=a.F):(b=0<c.length?c[0]:6,a.J=!0,a.F=xyc(a,e)),0<c.length&&a.L.push("Requested chart type is not supported for this question.")):
0<e.length&&1<a.H.length&&1<a.H[0].length&&(a.F=xyc(a,e),a.J=B(c,2)||!1,20<=a.H.length||3<=a.H[0].length)&&(a.J=!0),a.V=nyc(a.F,b,e,a.J))}}function xyc(a,b){if(!zc(a.C,18).length)return b[0];a=yyc(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(yb(b,a[c]))return a[c];return b[0]}function zyc(a,b,c){var d={};null!=b?(d.v=Ayc(a,b,c),d.f=b):d.v=null;return d}
function yyc(a){for(var b=new jE,c=a.H[0],d=Jb(a.H,1),e=zc(a.C,18),f=[],h=0;h<c.length;h++)e[h]&&uc(e[h],1)?f.push(Byc(B(e[h],1))):f.push(h?"number":"string"),b.Bt({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){h=[];for(var k=0;k<c.length;k++)h.push(zyc(a,d[e][k],f[k]));b.qx(h)}return b}
function Ayc(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return b=b||"0",a=WMa(a.va.L.C).DECIMAL_SEP,b=b.replace(new RegExp("[^-0-9"+a+"]","g"),""),b=b.replace(a,"."),lb(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&Sa(a[0])&&Sa(a[1])&&(Sa(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)Sa(a[d])&&
(c[d]=lb(a[d]));"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function Byc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function Cyc(a){if(!uc(a.C,9))return"";if(uc(a.C.getError(),3))switch(B(a.C.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.C.getError().Em()||""}
function vyc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return Cyc(a)||"Sorry, couldn't understand your question.";case 7:return a=iyc(a.D),-1!=a?hyc[a].Ug:""}return""}
function ryc(a){var b=[];if(pyc(a)){var c=[];x(Gb(a.Qa,a.Ja),function(a){c.push(Dyc(a,"waffle-assistant-answercard-question-unused-phrase"))});x(a.Ta,function(a){c.push(Dyc(a,"waffle-assistant-answercard-question-used-entity"))});Ob(c,function(a,b){return a.lB>b.lB?1:-1});var d=0;x(c,function(c){var e=c.length,h=c.lB;h>d?b.push({text:a.D.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.D.substring(h,d),className:c.rl}))});d<a.D.length&&b.push({text:a.D.substring(d),className:null})}else b.push({text:a.D,
className:null});return b}function Dyc(a,b){return{lB:B(a,2),length:B(a,3),rl:b}};function Eyc(a){this.Kb=a}function Fyc(a,b){var c=new TX;M(c,3,b);M(c,8,uva);b=new RU;Ri(b,4,c);c=new Zi;Ri(c,46,b);c=ij(hj(new gj,10),c).build();a.Kb.hc(2753,c)};function Gyc(a,b,c,d,e,f){G.call(this,"sqc");this.V=a;this.F=f||"";this.L=b;this.J=d;this.$=e;this.C=c}u(Gyc,G);function Hyc(a,b,c,d,e,f,h){d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;h=void 0===h?null:h;G.call(this,"answers-submit-query");this.C=a;this.V=b;this.L=c;this.J=d;this.$=e;this.F=f;this.va=h}u(Hyc,G);function Iyc(a,b,c){this.J=a;this.D=[];this.C=[];this.F=b;this.H=c}u(Iyc,D);function AY(a,b){BY(a);Jyc(a,b)}function Jyc(a,b){if(b){var c=$z(a.J);b=b.rect;if(ue(b)&&b.width&&b.height){var d=nob(c,b,a.H);a.Ca(d);d.setVisible(!0);a.D.push(d);c=SI(c,b,a.F,1,0);a.Ca(c);c.setVisible(!0);a.C.push(c)}}}function BY(a){Dc(a.D);Dc(a.C);a.D=[];a.C=[]};function CY(a,b,c,d){H.call(this);this.V=a;this.O=b;this.va=c;this.Ta=d;this.Ra=new J(this);this.Ca(this.Ra);this.C=new MW;this.Ca(this.C);this.L="";this.J=[];this.F=this.D=this.H=null;this.$=!1;hsc(this.C,this.V);this.C.Da=10;this.C.hb=!0;this.C.O=!1;this.C.GXa("waffle-assistant-visible");this.C.va=Ta("waffle-assistant-dragged-formula").split(" ");this.C.Ke();this.Ra.R(this.C,asc,this.Ja).R(this.C,dsc,this.Qa).R(this.C,esc,this.Da)}u(CY,H);CY.prototype.$e=ca("$");
CY.prototype.Ja=function(a){a=pb(this.V.childNodes,a.C);this.L=this.J[a]};
CY.prototype.Qa=function(a){var b=a.event instanceof Dq?a.event.jN:a.event;this.$?(a.J.kA(b,!0),a.preventDefault()):(Ro(a.F,a.event.clientX,a.event.clientY),a=So(a.F),b=$z(this.O).qe(),ae(cH(b,"page",!1,!1)).contains(a)?(a=aH(b,a.x,a.y,"page"),(b=Wx(mw(this.va),a.y,a.x))?a=new Pd(b.rc(),b.vc()):b=fe(a),this.H=a,this.D&&this.D.getRect().equals(b)||(a=$z(this.O),F(this.D),this.D=Qmc(a,b,"waffle-assistant-formula-insertion-rect"),this.Ca(this.D),TH(nJ(a),this.D),F(this.F),this.F=SI(a,b,"waffle-assistant-formula-insertion-border",
2,0),this.Ca(this.F),mkb(this.F,"#000"),this.F.setVisible(!0))):Kyc(this))};CY.prototype.Da=function(a){if(this.H){gJ($z(this.O),!1);var b=this.H,c=mw(this.va);b=new uH(c,b,this.L);this.Ta.C(b);this.dispatchEvent(new G("formula_inserted"))}a.J.kA(null,!0);a.preventDefault();this.L="";Kyc(this)};function Kyc(a){a.H=null;F(a.D);a.D=null;F(a.F);a.F=null};function Lyc(a){var b=a.error,c=a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+V(Xt({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';c?(b=V(b)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',a+='<div class="waffle-assistant-errorcard-text">'+b+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+V(b)+"</div>";
return W(a+"</div></div>")};function Myc(a){var b=W,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+Nyc({GO:a.hC.GO}),d=a.hC.j_;var e=a.hC.ep;var f=a.hC.interpretation,h=a.hC.q3,k=a.hC.Ol,l=a.hC.sYb,m=a.hC.J2;a=a.hC.dLb;!d||ya(d);ya(a);var r=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+Mr("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(f?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
V(f)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){if(!l){k&&(r+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-chart-tab" id="waffle-assistant-answercard-chart-tab">CHART</div></div>');r+='<div class="waffle-assistant-answercard-answer">';if(h){r+='<div class="waffle-assistant-answercard-answer-rowheader">';l=d[0];f=l.length;for(var v=0;v<f;v++)r+='<span class="waffle-assistant-answercard-answer-col">'+
V(l[v])+"</span>";r+="</div>"}r+='<div class="waffle-assistant-answercard-answer-rows">';l=Ir("waffle-assistant-answercard-answer-row"+(h?" waffle-assistant-answercard-answer-list-row":""));f=d.length;for(v=0;v<f;v++){var w=d[v];if(!h||v){var y=l;ya(w);y='<div class="'+X(y)+'">';for(var z=w.length,E=0;E<z;E++){var K=w[E];y=K?y+('<span class="waffle-assistant-answercard-answer-col">'+V(K)+"</span>"):y+('<span class="'+X("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+
'">N/A</span>')}w=W(y+"</div>")}else w="";r+=w}r+="</div></div>"}r+=k?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart-type-select"></div><div class="waffle-assistant-answercard-chart"></div></div>':"";m&&(r+='<div class="waffle-assistant-answercard-insert-pivot">INSERT PIVOT TABLE</div>')}if(0<a.length){r+='<div class="waffle-assistant-answercard-info-msgs">';d=a.length;for(h=0;h<d;h++)r+='<div class="waffle-assistant-answercard-info-msg">* '+
V(a[h])+"</div>";r+="</div>"}r+='<div class="waffle-assistant-answercard-footer">';k&&(r+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');r+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-help">Click to copy or drag to insert</div><div class="waffle-assistant-answercard-formula-display"><div class="waffle-assistant-answercard-formula-icon">'+
V(Xt({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+V(e)+"</div></div></div></div></div></div></div></div>";e=W(r);return b(c+e+"</div></div>")}
function Nyc(a){ya(a.GO);a=a.GO;var b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+Mr("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+X(e.className)+'">'+V(e.text)+"</span>":V(e.text)}return W(b+"</div></div></div>")}
function Oyc(){var a=W;var b=W('<div class="waffle-assistant-answers-card-remove">'+V(Xt({icon:"docs-icon-img docs-icon-trash"}))+"</div>");return a(V(b))};function DY(a,b,c,d,e,f,h,k,l,m,r){gY.call(this,new hw,r);this.C=a;this.Jf=tyc(a);this.Xb=a.Ol();this.Kd=a.J2();this.yc=a.Ol()&&a.J;this.Wb=a.$;this.$a=!1;this.Xd=b;this.vd=c;this.Xc=d;this.jg=h;this.Kb=e;this.Ye=f;this.Ee=k;this.sf=m;this.Ic=hj(new gj,10).build();this.Rb=new Ms("",new dY,this.xa());this.Xa(this.Rb);this.L=null;this.J=new Ms("",new cY,this.xa());this.Xa(this.J);this.Da=new Ms("",new cY,this.xa());this.Xa(this.Da);this.Ja=new Ms("",new dY,this.xa());this.Xa(this.Ja);this.H=new BV;
this.Xa(this.H);this.va=new AI("");this.Xa(this.va);this.F=null;this.Ac=yyc(this.C);this.eb=new Iyc(b,"waffle-assistant-answers-range-styled-border","waffle-assistant-answers-range-styled-rect");this.Ca(this.eb);this.qb=!1;this.Ta=new Ms("",new dY,this.xa());this.Xa(this.Ta)}u(DY,gY);p=DY.prototype;p.aoa=g("Ee");p.Ha=function(){DY.ea.Ha.call(this);Gwc(this).appendChild(U(Oyc))};
p.Sa=function(){DY.ea.Sa.call(this);var a=this.cb("waffle-assistant-answers-card-remove");this.Rb.pb(a);eY(a,"Remove card",0);this.getHandler().Kc(this.Rb,"action",this.i4b).R(this.J,"action",this.zFb).R(this.Da,"action",this.Wwb).Kc(this.J,"action",t(this.NSa,this,!0)).Kc(this.Da,"action",t(this.NSa,this,!1))};
p.hF=function(a){hY(this).appendChild(U(Myc,{hC:qyc(this.C)}));this.J.pb(this.cb("waffle-assistant-answercard-see-formula-link"));this.Da.pb(this.cb("waffle-assistant-answercard-hide-formula-link"));this.L=new CY(this.cb("waffle-assistant-answercard-formula-text-container"),this.Xd,this.vd,this.Xc);this.L.$e(this.Gd());this.L.J=[this.C.ep];this.Ca(this.L);var b=this.cb("waffle-assistant-answercard-formula-text");uq(b,"Formula: "+(this.C.ep+". Click/Press ENTER to copy or drag to insert on to sheet."));
this.getHandler().Kc(this.L,"formula_inserted",this.TMb).Yh(this.cb("waffle-assistant-answercard-formula-text"),cd,this.iwb);Pyc(this,this.sf);Qyc(this);if(this.Xb){if(this.Wb)Ryc(this,this.C.getChartType()),this.$a=!0;else{this.H.pb(this.cb("waffle-assistant-answercard-tabs"));b=new zV("");b.pb(this.cb("waffle-assistant-answercard-formula-tab"));this.H.Xa(b);var c=new zV("");c.pb(this.cb("waffle-assistant-answercard-chart-tab"));this.H.Xa(c);this.getHandler().R(this.H,"select",this.PHb).Kc(b,"action",
t(this.LSa,this,0)).Kc(c,"action",t(this.LSa,this,1));this.H.Ow(this.yc?c:b)}b=zc(B(this.C.C,17),1);for(c=0;c<b.length;c++)this.va.Nd(Syc(b[c]));this.va.pb(this.cb("waffle-assistant-answercard-chart-type-select"));Ht(this.va,Syc(this.C.F));b=this.cb("waffle-assistant-answercard-insert-chart");this.Ja.pb(b);Tyc(this);this.getHandler().R(this.Ja,"action",this.h4b).R(this.va.Dc(),"action",this.Lqb)}this.Kd&&(b=this.cb("waffle-assistant-answercard-insert-pivot"),this.Ta.pb(b),this.getHandler().R(this.Ta,
"action",this.$xb));a()};p.Bfa=function(){return this.Xb&&!this.Wb&&!this.yc};function Syc(a){if(a in yY)return new mt(yY[a].C,a);throw Error("Unknown chart type.");}p.Lqb=function(a){a=a.target.jb();if(a in yY)Ryc(this,yY[a].getChartType());else throw Error("Unknown chart type model.");};
function Ryc(a,b){a.F=new aw;C(a.F,1,b);C(a.F,2,a.C.interpretation||"");if("Histogram"===b)b=syc(a.C),C(a.F,3,b),C(a.F,6,"Count");else if("LineChart"===b||"ColumnChart"===b)b=0,"number"!=a.Ac.bd(0)&&(b=a.Ac.zg(0),C(a.F,3,b),b=1),1==a.Ac.getNumberOfColumns()-b?(b=a.Ac.zg(b),C(a.F,6,b)):C(a.F,6,"Values");else{b=a.F;var c=syc(a.C);C(b,3,c);c=a.C;c.Ol();C(b,6,c.H[0][1]||"")}b=Lwc(a.F);b.we(a.Ac);c=a.cb("waffle-assistant-answercard-chart");b=Mwc(b,c);tW(b,b.Fd());b.setOption("title","");GW(b,c,a.Kb,Tn);
a.$a=!0}p.$xb=function(){var a=mw(this.vd),b=this.C;b.J2();b=b.C?B(b.C,24):null;a=a.zc();b=WXa(b,a,new Pd(0,0),0);this.Xc.C(new wtc(b,a))};p.h4b=function(){if(this.F){var a=Lwc(this.F);a.we(this.Ac);tW(a,a.Fd());var b=this.O,c=this.Ac,d=this.C.F,e=new Qvc;M(e,1,d);d=new TX;Ri(d,11,e);e=new RU;Ri(e,4,d);d=new Zi;Ri(d,46,e);this.dispatchEvent(new owc(a,b,c,2874,void 0,void 0,d))}};p.bF=function(){uq(this.Ma,"Answer Card for question: "+this.C.D)};p.gF=jd;p.UC=n("assistantAnswersFeedback");p.oH=n(2628);
p.nH=n(2627);p.Gaa=n("Was this answer correct?");p.Xoa=n("Correct");p.Woa=n("Incorrect");p.HP=g("C");p.$e=function(a){DY.ea.$e.call(this,a);this.L&&this.L.$e(a);Qyc(this);Tyc(this)};p.z2=function(){DY.ea.z2.call(this);if(!this.qb){var a=this.eb,b=this.Jf;BY(a);for(var c=0;c<b.length;c++)Jyc(a,b[c]);this.qb=!0}};p.BU=function(){DY.ea.BU.call(this);BY(this.eb);this.qb=!1};p.PHb=function(){switch(CV(this.H)){case 0:Uyc(this,!1);break;case 1:Uyc(this,!0);break;default:CV(this.H)}};
function Uyc(a,b){N(a.cb("waffle-assistant-answercard-chart-container"),b);N(a.cb("waffle-assistant-answercard-answer"),!b);N(a.cb("waffle-assistant-answercard-formula-holder"),!b);Tyc(a);!a.$a&&b&&Ryc(a,a.C.getChartType())}function Qyc(a){var b=a.Jb("waffle-assistant-answercard-formula-help");b&&N(b,!a.Gd())}function Tyc(a){var b=(a.Wb||1==CV(a.H))&&!a.Gd();a.Ja.setVisible(b)}
function Pyc(a,b){a.J.setVisible(!b);a.Da.setVisible(b);N(a.cb("waffle-assistant-answercard-formula"),b);b?a.cb("waffle-assistant-answercard-formula-text").focus():(a.J.Ma.focus(),a.J.vq(!0))}p.i4b=function(){Fyc(this.Ye,!0);this.dispatchEvent(new G("rc"))};p.zFb=function(){Pyc(this,!0)};p.Wwb=function(){Pyc(this,!1)};p.NSa=function(a){var b=new TX;M(b,9,a);a=new RU;Ri(a,4,b);b=new Zi;Ri(b,46,a);b=ij(hj(new gj,10),b).build();this.Kb.hc(2849,b)};
p.LSa=function(a){var b=this.C.V,c=new Rvc;Ri(c,1,b);switch(a){case 0:M(c,2,2);break;case 1:M(c,2,1);break;default:M(c,2,0)}a=new TX;Ri(a,10,c);c=new RU;Ri(c,4,a);a=new Zi;Ri(a,46,c);c=ij(hj(new gj,10),a).build();this.Kb.hc(2850,c)};p.TMb=function(){this.Kb.hc(2709,this.Ic)};
p.iwb=function(){var a=this.xa().Ub(),b=a.createElement("textarea");b.textContent=this.C.ep;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&(EY(this.jg,"Formula copied to clipboard",this.xa()),this.Kb.C(35534,this.Ic))};function Vyc(){this.F=[];this.D={};this.J=null;this.C=new sP}function Wyc(a,b,c,d){function e(a){return a.toLowerCase()}Kb(b,void 0,e);Kb(c,void 0,e);Kb(d,void 0,e);x(b,a.H,a);x(c,a.H,a);x(d,a.H,a)}Vyc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(!d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function Xyc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}Vyc.prototype.XI=function(a,b,c){if(Ta(a||"")){var d=this.J.Um();d=Yyc(this,a.substring(0,d));var e=Zyc(this,b-d.length,a);d=Gb(d,e)}else d=Zyc(this,b);d.length>b&&(d=Jb(d,0,b));c(a,d)};
function Zyc(a,b,c){var d=c||"";c=Xb(a.D,function(a){return Ma(a,d)});var e=$yc(bc(c),d?1:2,1);a=rb(a.F,function(a){return Ma(a.query,d)&&!e[a.query.toLowerCase()]});b=$yc(a,b-ac(e),2);b=bc(b);var f=sb(b,function(a,b){a.nxa=b;return a.mZa});x(b,function(a){a.lxa=f});return Gb(b,bc(e))}
function Yyc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={$fa:h.$fa,R3:h.R3,FV:h.FV},++k)if(!k||" "==f[k-1]&&" "!=f[k]){h.FV={};h.R3=0;h.$fa=f.substr(k);var l=a.C.Te(h.$fa);x(l,function(b){return function(c){var d=c.length-b.$fa.length;b.R3=Math.max(d,b.R3);c=a.C.get(c);b.FV[d]||(b.FV[d]=[]);Ib(b.FV[d],c)}}(h));for(l=0;l<=h.R3&&0<d;++l){var m=h.FV[l];if(m)for(var r=0;r<m.length&&0<d;++r){var v=m[r];Ya(b.toLowerCase(),v.toLowerCase())||e[v]||(--d,c.push({text:v,ep:"",nB:0,
JFa:f.length-k,mZa:void 0,lxa:[],nxa:-1}),e[v]=!0)}}}return c}function $yc(a,b,c){b=uxc(a.length,Math.min(a.length,b));var d={};x(b,function(b){b=a[b];var e=na(b)?b:b.query;d[e.toLowerCase()]={text:e,ep:na(b)?"":b.ep,nB:c,JFa:0,mZa:na(b)?void 0:b.type,lxa:[],nxa:-1}});return d};function FY(){HH.call(this,"",null,!1)}u(FY,HH);FY.prototype.sE=function(a,b){if(2==a.nB||1==a.nB)return FY.ea.sE.call(this,a.text,b);var c=this.Ya(),d=this.Um(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.JFa)+a.text;e||(f+=" ");a=FY.ea.sE.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.Bk;b.blur();b.focus();this.S4(f.length);return a};
FY.prototype.Gg=function(a){var b=FY.ea.Gg.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,Yib(b)&&b.xH()&&a.preventDefault(),b=!0);return b};function azc(){return W('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+V(Xt({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+V(Xt({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+V(Xt({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function bzc(a){this.rb=a||Km()}
bzc.prototype.Iw=function(a,b,c){b=U(azc);var d=this.rb.cb("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.rb.qf(d,a.text);d=this.rb.cb("waffle-assistant-answers-ac-entity-icon",b);var e=this.rb.cb("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.rb.cb("waffle-assistant-answers-ac-session-query-icon",b);N(d,0==a.nB);N(e,2==a.nB);N(f,1==a.nB);d="";switch(a.nB){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&T(c,d);this.rb.appendChild(c,b)};function czc(a){var b=a.type;if(!q(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":b=[];for(var c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return q(a.value)?a.value:null}}
function dzc(a,b){var c=a.type;if(q(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(na(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":na(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};function ezc(a,b,c,d){P.call(this,d);this.F=new Ms("",new dY,this.xa());this.Xa(this.F);this.V=new OW(!1,"#4285f4");this.Xa(this.V);this.J=new FY;this.J.wKa=!0;this.J.Qa=!0;this.Ca(this.J);this.O=b;this.O.J=this.J;b=new FH(null,new bzc(d));this.D=new DH(this.O,b,this.J);this.Ca(this.D);this.Kb=a;this.L=!1;this.va=hj(new gj,c).build();this.H=this.xc=this.C=this.$=null}ha(ezc,P);p=ezc.prototype;
p.Sa=function(){P.prototype.Sa.call(this);var a=this.D.Be();a.className="waffle-assistant-answers-ac-renderer";a.UO="waffle-assistant-answers-ac-row";a.r8="waffle-assistant-answers-ac-active";a.Xra="waffle-assistant-answers-ac-highlighted";this.J.C=this.D;this.D.r_=!1;this.D.Cda=6;this.getHandler().R(this.D,"update",this.hpb)};
p.zd=function(a){P.prototype.zd.call(this,a);var b=this.xa();this.xc=a;this.H=b.cb("waffle-assistant-answers-query-box",a);this.F.pb(b.cb("waffle-assistant-answers-clear-query-button",this.H));this.$=b.cb("waffle-assistant-answers-spinner-container",this.H);this.V.render(this.$);this.C=b.cb("waffle-assistant-answers-input-box",this.H);jjb(this.J,this.C);eY(this.F.getElement(),"Clear query");fzc(this,this.getHandler());this.F.setVisible(!1)};p.La=function(){P.prototype.La.call(this);this.O.J=null};
p.setVisible=function(a){this.xc&&(N(this.xc,a),(a=tv)&&a.dispatchEvent("resize"))};function gzc(a,b,c){c=void 0===c?!1:c;dzc(a.C,b);c&&a.C.focus();a.l_a()}function fzc(a,b){b.R(a.H,"submit",a.HNb).R(a.H,"focus",function(){return hzc(a,!0)},!0).R(a.H,"blur",function(){return hzc(a,!1)},!0).R(a.F,"action",a.R9a).R(a.C,"input",a.l_a).R(a.C,"focus",a.KWa)}
p.hpb=function(a){a.row&&(a=a.row,2==a.nB?(izc(this,1,a.lxa,a.nxa,a.ep,2),this.Kb.hc(2652,this.va)):0==a.nB?(this.L=!0,this.Kb.hc(2651,this.va)):1==a.nB&&izc(this,3))};function hzc(a,b){mq(a.H,"waffle-assistant-answers-query-box-focused",b);a.D.Sf()&&!b&&a.D.Ii()}p.l_a=function(){this.F.setVisible(!!czc(this.C))};p.KWa=function(){this.D.Pw(this.C);var a=db(czc(this.C));this.J.S4(a.length);Vib(this.D,a||"  ");this.D.update(!0)};p.HNb=function(a){a.stopPropagation();a.preventDefault();izc(this,2)};
function izc(a,b,c,d,e,f){c=void 0===c?null:c;d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;var h=Ta(czc(a.C));a.F.setVisible(!!h);jzc(a);a.dispatchEvent(new Hyc(b,h,a.L,c,d,e,f));a.L=!1}p.R9a=function(){dzc(this.C,"");this.F.setVisible(!1)};function kzc(a,b){N(a.$,b);N(a.xa().cb("waffle-assistant-answers-button-container",a.H),!b);a.V.setActive(b)}function jzc(a){a.C.blur();a.D.Sf()&&a.D.Ii()};function lzc(a){return W('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+V(Nyc({GO:a.FJa.GO}))+V(Lyc({error:a.FJa.error,showHelp:a.showHelp}))+"</div></div>")}function mzc(){return W('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function GY(a,b,c,d,e){gY.call(this,new hw,e);this.H=a;this.va=b;this.L=d;this.Da=c;this.J=new Ms("",new dY,this.xa());this.Xa(this.J);this.C=new Ms("",new cY,this.xa());this.Xa(this.C);this.F=new Ms("",new cY,this.xa());this.Xa(this.F)}u(GY,gY);p=GY.prototype;p.bF=function(){uq(this.Ma,"Error Card for question: "+this.H.D)};p.UC=n("assistantAnswersFeedback");p.gF=jd;p.uca=id;p.Ha=function(){GY.ea.Ha.call(this);Gwc(this).appendChild(U(Oyc))};
p.Sa=function(){GY.ea.Sa.call(this);var a=this.cb("waffle-assistant-answers-card-remove");this.J.pb(a);this.F.setVisible(this.L);eY(a,"Remove card",0);this.getHandler().Kc(this.J,"action",this.o4b).Kc(this.C,"action",this.KFb).R(this.F,"action",this.n4b)};
p.hF=function(a){hY(this).appendChild(U(lzc,{FJa:uyc(this.H),showHelp:this.L}));if(Mn){var b=U(mzc);this.xa().appendChild(this.Ma,b);this.C.pb(this.cb("waffle-assistant-answercard-feedback-link"))}this.L&&this.F.pb(this.cb("waffle-assistant-answers-helpcenter-link"));a()};p.aoa=g("va");p.HP=g("H");p.KFb=function(){this.C.setVisible(!1);N(this.cb("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new G("trigger_feedback"))};p.o4b=function(){Fyc(this.Da,!1);this.dispatchEvent(new G("rc"))};
p.n4b=function(){Q.So.Bc()};function nzc(a){gY.call(this,new hw,a);this.C=this.xa().createElement("div");nn(this.C,"Previous")}u(nzc,gY);p=nzc.prototype;p.bF=function(){uq(this.Ma,"Previous questions below")};p.Ha=function(){nzc.ea.Ha.call(this);kq(this.Ma,"waffle-assistant-card");T(this.Ma,"waffle-assistant-answers-previousheadercard")};p.hF=function(a){0<this.xa().xi(hY(this)).length||hY(this).appendChild(this.C);a()};p.uca=id;p.UC=n("assistantAnswersFeedback");function ozc(a){var b=""+((a.D$?V(Lyc({error:a.D$,showHelp:a.showHelp})):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+V(a.title)+"</div>":""));var c=Ir("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.oB;for(var d=a.length,e=0;e<d;e++){var f=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+X(c)+'">'+V(Xt({icon:"docs-icon-img docs-icon-help"}))+
'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+V(f)+"</div></div></div>"}return W(b+"</div>")};function HY(a,b,c,d,e,f){gY.call(this,a,f);this.C=e||null;this.va=b;this.F=d;this.Da=c;this.L=this.C?5==this.C.error:!1;this.H=new Ms("",new cY,this.xa());this.Xa(this.H);this.J=new Ms("",new dY,this.xa());this.Xa(this.J)}u(HY,gY);p=HY.prototype;p.Ha=function(){HY.ea.Ha.call(this);this.gF()&&Gwc(this).appendChild(U(Oyc))};
p.Sa=function(){HY.ea.Sa.call(this);T(this.Ma,"waffle-assistant-answers-suggestioncard");this.H.setVisible(this.L);this.getHandler().R(this.H,"action",this.p4b);if(this.gF()){var a=this.cb("waffle-assistant-answers-card-remove");this.J.pb(a);eY(a,"Remove card",0);this.getHandler().Kc(this.J,"action",this.q4b)}};p.oH=function(){return yb([pzc,IY],this.F)?2799:yb([qzc,rzc],this.F)?2801:null};p.nH=function(){return yb([pzc,IY],this.F)?2798:yb([qzc,rzc],this.F)?2800:null};p.Gaa=n("Were these interesting?");
p.Xoa=n("Interesting");p.Woa=n("Not interesting");p.UC=n("assistantAnswersFeedback");p.gF=function(){return this.C?!pyc(this.C):!1};p.bF=function(){var a=this.F.title;a&&this.C?uq(this.Ma,a+(" for question : "+this.C.D)):uq(this.Ma,"Suggested questions")};
p.hF=function(a){var b=this;this.Da.then(function(c){if(b.gc()){if(c.length){var d=b.xa(),e=hY(b);if(!d.xi(e).length){var f=U(ozc,{title:b.F.title,oB:sb(c,function(a){return a.query}),D$:b.C?vyc(b.C):"",showHelp:b.L});e.appendChild(f);var h=sb(c,function(a){return a.type});e=b.Zi("waffle-assistant-answercard-question-container");x(e,function(a,e){var f=new Ms("",new dY,d);b.Xa(f);f.pb(a);b.getHandler().R(f,"action",t(b.BHb,b,c[e],h,e))});b.L&&b.H.pb(b.cb("waffle-assistant-answers-helpcenter-link"))}}else N(b.Ma,
!1);a()}})};p.q4b=function(){Fyc(this.va,!1);this.dispatchEvent(new G("rc"))};p.BHb=function(a,b,c){this.dispatchEvent(new Gyc(this.F.p5,a.ep||null,b,c,this.F.H_,a.query))};p.p4b=function(){Q.So.Bc()};var szc={title:"",H_:0,p5:null},pzc={title:"",H_:5,p5:1},IY={title:"Suggested questions",H_:5,p5:1},rzc={title:"Did you mean?",H_:2,p5:4},qzc={title:"Related questions",H_:4,p5:4};function tzc(){var a=Ir("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input type="text" class="waffle-assistant-answers-input-box" placeholder="'+X(a)+'" aria-label="'+X(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+X("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+V(Xt({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return W(a)};function JY(a,b,c,d,e,f,h,k,l,m,r,v,w){lY.call(this,w);this.Xd=c;this.Dd=d;this.Ye=e;this.jc=a;this.hb=new byc(this.Dd);this.$a=h;this.Ja=m;this.sf=r;this.Ee=v;this.L=this.D=this.Db=this.F=null;this.Rb="";this.va=new Vyc;this.Kb=f;this.Da=this.Wb=this.Qa=this.H=null;this.Ta=k;this.vd=!1;this.yb=hj(new gj,10).build();this.qd=new ah;this.qb=l;this.V={};this.Xc=ai();this.kb="";this.$=null}u(JY,lY);p=JY.prototype;p.Sa=function(){JY.ea.Sa.call(this);this.gJ(!this.H)};
p.yva=function(a,b){JY.ea.yva.call(this,a,b);b=this.xa();var c=this.O,d=U(tzc);b.appendChild(a,d);this.D=new ezc(this.Kb,this.va,10,b);c.Xa(this.D);this.D.pb(d);c.getHandler().R(this.D,"answers-submit-query",t(this.k4b,this))};p.H9=function(){JY.ea.H9.call(this);this.D=null};p.gJ=function(a){var b=this;this.D&&this.D.setVisible(!a);a?(this.$&&this.$.dispose(),this.$=new jl(function(){JY.ea.gJ.call(b,a)},300,this),this.Ca(this.$),this.$.start()):(this.$&&this.$.stop(),JY.ea.gJ.call(this,a))};
p.dg=ca("Db");
function uzc(a,b,c,d,e,f,h){h=h?h:[];a.hb.Ke(c,b,d,e,h);h=sb(zc(c,1),function(a){return a.getName()});var k=[],l=[];x(zc(c,2),function(a){k.push(a.getName());l=l.concat(zc(a,2))});Wyc(a.va,h,k,l);a.jc.Rda().then(function(a){this.va.F=a;this.D&&(a=this.D,Cn(a.xa())==a.C&&a.KWa())},null,a);a.H=b;a.Qa=d;a.Wb=e;a.Da=c;a.yb=ij(hj(new gj,10),vzc(a)).build();if(f&&Xn)for(c=sb(a.C,function(a){if(a instanceof DY||a instanceof GY)return a.HP().D}),a.L_(),d=0;d<c.length;d++)if(e=c[d])f=new SX,M(f,1,5),wzc(a,
e,f);a.gJ(!b)}p.reset=function(){sV(this.V);sV(this.va.D);var a=this.va;a.F=[];a.C.clear();this.L=null;this.fHa()};
function wzc(a,b,c,d,e){d=void 0===d?null:d;e=void 0===e?!1:e;var f=a.Ja.L.fw();M(c,13,f);f=new TX;Ri(f,5,c);jzc(a.D);if(!a.Db||3<=a.Db.getStatus().getState().C)if(a.V[b])xzc(a,b,!1);else{d=new zY(b,null,null,null,2,a.Ja);yzc(a,d,!0,f);return}else{var h=a.V[b];h&&h instanceof GY&&2==h.HP().error&&delete a.V[b]}if(b&&a.H)if(a.V[b])a.Kb.hc(2681,a.yb),xzc(a,b,!0);else{h=vzc(a);var k=Pi(Pi(h,RU,46),TX,4);M(k,2,e);e=ij(hj(new gj,10),h).build();a.Kb.hc(2635,e);e=$w(a.H.rect);b=Al(Bk(Bl(Dk(Ek(a.Db.zf("/answers/parse").Yf("q",
b,"qt",L(c,1),"gid",a.H.Zc,"range",e,"context",a.Rb),t(a.Uk,a,b,f)),t(a.j4b,a,b,f)),"POST"),2));Xn&&a.Qa&&null!=a.Wb&&(c=a.Qa.rect.width&&a.Qa.rect.height?$w(a.Qa.rect):"",b.Yf("headerRange",c,"tableRecordDimension",""+a.Wb));d&&b.Yf("sgfml",d);b.Re();a.kb=bi(a.Xc,hk.dza);kzc(a.D,!0)}else gzc(a.D,"")}function xzc(a,b,c){var d=a.V[b];d!=ob(a.C)&&(1<a.C.length&&zzc(a),c&&Azc(a,d.HP()).then(function(a){Bzc(this,d,a)},null,a),kxc(a,d))}
p.k4b=function(a){var b=a.C;var c=a.va;var d=a.J,e=a.$;c?c=jyc(b,d,e,c):(c=new SX,M(c,1,b));wzc(this,a.V,c,a.F,a.L)};p.j4b=function(a,b){if(this.H){var c=L(Pi(b,SX,5),1);c=1==c||4==c?Xvc.EDa:Xvc.cEa;var d=vzc(this),e=Pi(Pi(d,RU,46),TX,4);M(e,1,c);M(b,1,c);c=ij(hj(new gj,10),d).build();this.Kb.hc(2640,c);Czc(this,a,b)}};function Czc(a,b,c){kzc(a.D,!1);b=new zY(b,null,null,null,3,a.Ja);yzc(a,b,!1,c);Dzc(a)}
p.Uk=function(a,b,c){this.H&&this.Ta.C.D.Yd.then(function(){var d=null,e=null,f=!1,h=Pi(b,SX,5),k=L(h,1),l=vzc(this);k=1==k||4==k?Xvc.EDa:Xvc.cEa;var m=Pi(Pi(l,RU,46),TX,4);M(m,1,k);M(b,1,k);l=ij(hj(new gj,10),l).build();if(c.Tl()){e=this.qd.Pc(WX.Pa(),c.Lf());if(f=e.getStatus()){switch(f){case 1:var r=2639;break;case 2:r=2643;break;case 3:r=2644;break;case 4:r=2638;break;case 5:r=2707;break;case 6:r=2706}r&&this.Kb.hc(r,l)}r=B(e,10);M(h,4,r);r=B(e,11);M(h,5,r);uc(e,16)&&(r=B(e,16),M(h,16,r));if(1==
f){Czc(this,a,b);return}if(2==f){e=-1!=Ezc(a);h=-1!=iyc(a);f=4;d=Pi(b,SX,5);e?(f=5,M(d,8,2)):h&&(f=7,M(d,8,1));h=new zY(a,null,null,null,f,this.Ja);e?(e=new GY(h,!0,this.qb,!0,this.xa()),Fzc(this,h,e,b)):yzc(this,h,!0,b);kzc(this.D,!1);Dzc(this);return}r=uc(e,2)?B(e,2):null;f=!0;if(r){k="";d=Yxc(this.Ta,r,this.H,!!this.Da&&!!B(this.Da,4));M(h,14,!!d);if(!d){if(m=r.match(/([A-Z]*)\(/)){var v=Pi(Pi(mma(l),RU,46),TX,4);M(v,7,m[1]);M(b,7,m[1])}this.Kb.hc(2645,l)}d&&Zxc(d)||(l=this.Ta,v=this.H,k="="!=
r[0]?"="+r:r,m=Gzc(l),v=Hzc(m,v),k=uDb(l.C,k,m,v.row,v.Kj));l=uc(e,19)?Yxc(this.Ta,B(e,19)||"",this.H,!!this.Da&&!!B(this.Da,4)):d;d=new zY(a,d,"="!=r[0]?"="+r:r,e,null,this.Ja,l);uc(e,23)&&d.Ol()?this.Rb=Ac(e,23):this.Rb="";k&&d.L.push(k);d.Ol()&&Ri(h,15,d.V)}else uc(e,9)&&(r=e.getError(),d=new zY(a,null,null,e||null,6,this.Ja),l=B(r,2),M(h,6,l),uc(r,3)&&(r=B(r,3),M(h,12,r)))}else this.Kb.hc(2640,l);d||(d=new zY(a,null,null,e||null,4,this.Ja));kzc(this.D,!1);pyc(d)?Izc(this,d,f,b):yzc(this,d,f,b);
Dzc(this)},function(){Czc(this,a,b)},this)};function Dzc(a){""!=a.kb&&(ci(a.Xc,a.kb),a.kb="")}function Jzc(a){if(null!=a.ep)return qzc;switch(a.error){case 4:case 6:return 0<a.O.length?rzc:IY;case 5:return IY}return szc}function vzc(a){var b=new TX;M(b,8,uva);var c=new RU;Ri(c,4,b);a=Pwc(a.H);Ri(a,46,c);return a}function Ezc(a){return xb(gyc,function(b){return Ma(a,b)})}
function Kzc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=B(b[d],2),f=!!a.Da&&!!B(a.Da,4);e=Yxc(a.Ta,e,a.H,f);Zxc(e)&&(e={query:B(b[d],1),ep:B(b[d],2),type:b[d].getType()},uc(b[d],5)&&(e.tKa=B(b[d],5)),c.push(e))}return pj(c)}function Izc(a,b,c,d){c=new DY(b,a.Xd,a.Dd,a.Ye,a.Kb,a.qb,a.$a,c,0,a.vd,a.xa());Fzc(a,b,c,d)}
function Lzc(a,b,c){if(a.F&&a.F.mb())hK(a.F);else{var d=a.sf.D.C["ritz-ap"]||null;c.Bfa()&&(a.F=jK(a.Ee,a.xa(),d,void 0,"answersChartsPromo"),a.F&&(a.F.show(),a.Ca(a.F),a.getHandler().Kc(a,"ze",a.fHa)));b.Ol()&&A2a(d,"answersChartsPromo")}}p.Jga=function(){JY.ea.Jga.call(this);this.F&&this.F.mb()&&this.F.C.xd()};p.fHa=function(){this.F&&this.F.mb()&&hK(this.F)};function yzc(a,b,c,d){c=new GY(b,c,a.qb,!1,a.xa());Fzc(a,b,c,d)}
function Fzc(a,b,c,d){zzc(a);var e=Azc(a,b,d);Mzc(a,c);c instanceof DY&&Lzc(a,b,c);Nzc(a);pyc(b)&&Xyc(a.va,b.D);e.then(function(a){if(d){var b=vzc(this),e=Pi(b,RU,46);Ri(e,4,d);b=ij(hj(new gj,10),b).build();this.Kb.hc(2781,b)}Bzc(this,c,a)},null,a);c.aoa()&&(a.V[b.D]=c);a.getHandler().R(c,"rc",a.TPa)}function Bzc(a,b,c){b instanceof GY&&c&&fp(c.getElement())&&(b=b.getElement(),N(b,!1),a.getHandler().R(c,"rc",a.TPa))}
function zzc(a){Ozc(a);x(a.C,function(a){a instanceof GY&&(a=a.getElement(),N(a,!0))});Pzc(a)}function Pzc(a){a.C.length&&(a.L?kxc(a,a.L):(a.L=new nzc(a.xa()),Mzc(a,a.L)))}function Ozc(a){x(a.C,function(b){b instanceof DY||b instanceof GY||b==a.L||a.TI(b)})}function Qzc(a,b){var c=pj([]);b=b.Da;0<b.length&&(c=eyc(a.hb,b));return c=c.then(function(b){var c=3-b.length;return 0<c?Oxc(a.jc,c).then(function(a){return Gb(b,a)}):pj(b)})}
function Azc(a,b,c){var d=Jzc(b),e=null;d==qzc||d==rzc?0<b.O.length&&(e=Kzc(a,b)):d==IY&&(e=Qzc(a,b));var f=null;return e?(f=new HY(new hw,a.qb,e,d,b,a.xa()),Mzc(a,f),a.Kb.hc(2769,a.yb),a.getHandler().R(f,"sqc",t(a.AHb,a)),e.then(function(a){if(c){var b=Pi(c,SX,5);yb([qzc,rzc],f.F)?(a=lyc(a),Ri(b,7,a)):yb([pzc,IY],f.F)&&(a=myc(a),Ri(b,9,a))}return f},null,a)):pj(f)}p.AHb=function(a){gzc(this.D,a.F,!0);var b=a.V;b=1==b?jyc(b,a.C,a.J,3):kyc(b,a.C,a.J,a.$);wzc(this,a.F,b,a.L);this.Kb.hc(2762,this.yb)};
function Mzc(a,b){b.$e(a.Gd());a.C.push(b);if(a.Ze){jxc(a,!1);var c=a.J.jd();b.O=c;a.J.Lh(b,0,!0);b.wL()}Iwc(b,!0)}function Nzc(a){for(var b=a.C;5<b.length;)a.TI(b[0])}p.L_=function(){JY.ea.L_.call(this);this.reset()};
p.TPa=function(a){var b=this,c=this.xa();a=a.target;if(a instanceof DY)this.TI(a),EY(this.$a,"Answer removed",c,t(this.tEb,this,a));else if(a instanceof GY)this.TI(a),EY(this.$a,"Card removed",c);else if(a instanceof HY&&a.C&&!pyc(a.C)){var d=a.C.D;x(this.C,function(a){a instanceof GY&&a.HP().D==d&&(b.TI(a),EY(b.$a,"Card removed",c))})}a=this.C;!this.L||a[0]!=this.L&&a[a.length-1]!=this.L||(this.TI(this.L),this.L=null)};
p.tEb=function(a){Izc(this,a.HP(),a.aoa());EY(this.$a,"Remove answer undone",this.xa())};p.TI=function(a){if(a.gc()){if(a instanceof DY||a instanceof GY)delete this.V[a.HP().D],a==ob(this.C)&&Ozc(this);JY.ea.TI.call(this,a)}F(a)};function Rzc(a,b){this.C=a;this.D=b}function Yxc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=Gzc(a);c=Hzc(e,c);(a=Fvc(a.C,b,e,c.row,c.Kj))&&d&&a.length<a[0].length&&(a=vxc(a));return a}function Zxc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function Gzc(a){a=lw(a.D);return null!=a?a.toString():"0"}
function Hzc(a,b){var c={row:0,Kj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Nc()+1?c.row=b.Nc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.Sc()+1&&(c.Kj=b.Sc()+1));return c};function Szc(){var a=""+(W('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
V(Xt({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+Mr("Ask a question about your data")+'"/></div></form></div>');return W(a)};function KY(a,b,c,d,e,f,h,k,l,m){mY.call(this,1,f,e,m);this.yb=c;this.Ja=null;this.va=new Ms("",new cY,this.xa());this.Xa(this.va);this.Qa=new Ms("",new cY,this.xa());this.Xa(this.Qa);a=new xDb(a,!0,!0);a=new Rzc(a,c);this.kb=new Eyc(e);this.O=new Uxc(this.yb,a,e);this.L=new JY(this.O,0,b,c,d,e,this.hb,a,this.kb,h,k,l,m);c=Tzc;this.D=new Iyc(b,c.A3a,c.B3a);this.Ca(this.D);this.F=this.H=null;this.qb=hj(new gj,10).build();this.Da=!1}u(KY,mY);
var Tzc={A3a:"waffle-assistant-answers-styled-border",B3a:"waffle-assistant-answers-styled-rect",M3a:"waffle-assistant-answers-input-box",h5a:"waffle-assistant-answers-query-box",axc:"waffle-assistant-answers-query-box-focused",b4a:"waffle-assistant-answers-learn-more",Urc:"waffle-assistant-answers-logging-message-container",M4a:"waffle-assistant-answers-logging-opt-out"};p=KY.prototype;p.Ha=function(){KY.ea.Ha.call(this);var a=U(Szc);this.xa().appendChild(mxc(this),a)};
p.Sa=function(){KY.ea.Sa.call(this);var a=Tzc,b=this.cb(a.h5a),c=this.cb(a.M3a);this.Qa.pb(this.cb(a.M4a));this.va.pb(this.cb(a.b4a));this.getHandler().R(b,"focus",this.EDb,!0).R(b,"blur",this.CDb,!0).R(b,"mouseover",this.GDb).R(b,"mouseout",this.FDb).R(b,"click",this.DDb).R(c,"input",this.l4b).R(this.Qa,"action",this.WBb).R(this.va,"action",this.Byb).R(ww(this.yb),"Ea",noc(this.m4b,25,this));this.setVisible(!!this.H);Uzc(this,ava&&dva&&Yn("showAnswersLoggingOptOut"))};p.sYa=id;p.IQa=jd;p.Dwa=id;
p.pX=n("Answers");p.Iga=n(1);p.U8=function(a){return 3==a||0==a};p.a6=function(a,b){Ob(a,function(a,b){return B(b,2)-B(a,2)});for(var c=[],d=null,e=0;e<a.length;e++){var f=Ac(a[e],1);3==f?d=a[e]:0==f&&c.push(B(a[e],8))}if(d&&B(d,2)){e=b||null;f=uc(d,11)?B(d,11):null;var h=null==f?null:IU(B(d,10));0<vc(d,4)?Vzc(this,IU(NU(d)),B(d,9),h,f,c):Vzc(this,e,B(d,9),h,f,c);this.F||(KY.ea.a6.call(this,a,b),this.getHandler().R(this.F,"sqc",this.zHb))}else this.oX(!0)};
p.W_=function(a){if(!this.F){var b=Oxc(this.O,3);this.F=new HY(a,this.kb,b,pzc,void 0,this.xa())}return this.F};p.AGa=g("L");p.Nra=function(){return this.mb()};
p.oX=function(a,b,c){this.O.reset();(a||b)&&this.F&&(KY.ea.oX.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||q(b)&&!b)this.F&&(KY.ea.oX.call(this,a,b,c),this.F.dispose(),this.F=null),this.gc()&&(this.O.reset(),this.H=null,a=this.L,a.gc()&&(b=a.va,b.F=[],b.C.clear(),a.D&&(b=a.D,b.gc()&&(b.C&&dzc(b.C),b.F.isDisposed()||b.F.setVisible(!1),b.L=!1)),a.L_(),a.hb.reset(),a.H=null,a.gJ(!0)),this.setVisible(!1),this.dc()&&BY(this.D));c&&this.L.reset()};p.dg=function(a){this.Ja=a;this.L.dg(a);this.O.dg(a)};
p.setActive=function(a){KY.ea.setActive.call(this,a);a?AY(this.D,this.H):BY(this.D)};function Wzc(a,b){a.dc()&&(b?BY(a.D):AY(a.D,a.H))}function Uzc(a,b){N(a.cb("waffle-assistant-answers-logging-message-container"),b)}function Xzc(a,b){a=a.cb("waffle-assistant-answers-query-box");mq(a,"waffle-assistant-answers-query-box-focused",b)}p.m4b=function(){this.dc()&&AY(this.D,this.H)};p.EDb=function(){Xzc(this,!0);AY(this.D,this.H)};p.CDb=function(){Xzc(this,!1);this.dc()||BY(this.D)};
p.GDb=function(){AY(this.D,this.H)};p.FDb=function(){this.dc()||BY(this.D)};p.DDb=function(){Yzc(this,"")};p.l4b=function(){var a=this.cb("waffle-assistant-answers-input-box");Yzc(this,a.value);a.value=""};p.zHb=function(a){var b=this,c=a.F;Yzc(this,c);var d=jyc(1,a.C,a.J,1),e=new jl(function(){wzc(b.L,c,d,a.L)},300);this.Ca(e);e.start();this.bt().hc(2652,this.qb)};
function Yzc(a,b,c){a.setActive(!0);a.dispatchEvent("Ee");var d=new jl(function(){gzc(a.L.D,b,!0);var d=a.L,f=c||!1;d.vd=f;d.jc.$=f;d.hb.$=f},300);a.Ca(d);d.start()}function Vzc(a,b,c,d,e,f){c=c||new ew;a.H=b;a.O.Ke(c,b,d,e,f);a.O.Qda();a.setVisible(!!b);uzc(a.L,b,c,d,e,a.Da,f);a.Da=!1;a.dc()&&AY(a.D,a.H)}p.WBb=function(a){a.stopPropagation();a.preventDefault();this.Ja&&(Bl(Dk(Ek(this.Ja.zf("/answers/logoptout"),t(this.nzb,this)),t(this.mzb,this)),"POST").Re(),this.bt().hc(2663,this.qb))};
p.Byb=function(a){a.stopPropagation();a.preventDefault();Vs("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};p.nzb=function(a){a.Tl()&&Uzc(this,!1)};p.mzb=ba();function Zzc(a,b,c){H.call(this);this.C=CLa(BLa.getInstance(),a,b,c);this.D=bl()}u(Zzc,H);Zzc.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!wb(c,function(a){return Eda(a,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].Nh()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&DLa(this.C),this.D=$zc(),this.D.addCallback(function(){return FLa(d.C,b)}))};Zzc.prototype.dg=function(a){this.C.dg(a)};
function $zc(){var a=null,b=new Vk(function(){null===a||yj(a)});a=xj(function(){b.Zb()});return b};function aAc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+X(a.title)+'">'+V(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+Mr("Press enter to insert formula")+'"></span></div>');return W(a)};function LY(a,b){P.call(this);this.C=a;this.D=b}u(LY,P);p=LY.prototype;p.Ha=function(){this.Ma=U(aAc,{name:this.C,title:this.D})};p.Sa=function(){LY.ea.Sa.call(this);var a=this.cb("waffle-assistant-quicksum-entry-name");eY(a);this.getHandler().R(this.Ma,"keypress",this.U3b);N(this.Ma,!1)};p.getFunctionName=g("C");p.ib=function(a){nn(this.cb("waffle-assistant-quicksum-entry-value"),a||"");N(this.Ma,!!a)};p.mb=function(){return fp(this.Ma)};
p.U3b=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new G("insert",this)))};function MY(a,b,c,d,e){P.call(this,e);this.Qa=a;this.Da=b;this.L=c;this.Kb=d;this.D=a.C;this.Ja=new ah;this.V=hj(new gj,17).build();this.O=hj(new gj,2).build();this.J=!1;this.F=[];this.C=null;this.H=[]}u(MY,P);
MY.prototype.Sa=function(){MY.ea.Sa.call(this);this.Lh(new LY(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Lh(new LY(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Lh(new LY(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Lh(new LY(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Lh(new LY(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new CY(this.Ma,
this.Da,this.D,this.L);this.C.$e(this.J);this.Ca(this.C);this.getHandler().R(this,"insert",this.$).R(this.C,"formula_inserted",this.va)};
function bAc(a){function b(a){return l?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,m):null}if(Gw(a.D)){var c=mw(a.D),d=c.qk(),e=AD(a.D);if(vb(d,c.Xt,c)){c=[];a.F=[];for(var f=0;f<d.length;f++){var h=d[f],k=bh(e+"",h.vc(),h.rc(),h.Nc(),h.Sc());c.push(a.Ja.serialize(k));a.F.push(h)}if(d=ritz_api.RitzModelApi.quickSum(c)){N(a.Ma,!0);e=d.count;c=d.countNumberFormat;var l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.kd(0).ib(b(d.sum));a.kd(1).ib(b(d.average));a.kd(2).ib(b(d.min));a.kd(3).ib(b(d.max));
1<e?a.kd(4).ib(ritz_api.RitzModelApi.renderNumberAsFormattedString(e,c)):N(a.Ma,!1);if(a.C){a.C.J=[];a.H=[];for(d=0;d<a.jd();++d)e=a.kd(d),a.H.push(cAc(a,e.getFunctionName()));a.C.J=a.H}}else N(a.Ma,!1)}else N(a.Ma,!1)}else N(a.Ma,!1)}MY.prototype.$e=function(a){this.J=a;this.C&&this.C.$e(a);mq(this.Ma,"waffle-assistant-quicksum-panel-readonly",a)};
MY.prototype.$=function(a){var b=a.target;a=this.F[0];a=new Pd(a.left,a.Nc());b=b.getFunctionName();b=cAc(this,b);a=new uH(mw(this.D),a,b);this.L.C(a);this.Kb.hc(2624,this.O)};MY.prototype.va=function(){this.Kb.hc(2624,this.V)};function cAc(a,b){var c=dNa(a.Qa.L);a=sb(a.F,function(a){return $w(a)});return"="+b+"("+a.join(c)+")"};function dAc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+V(Ts({content:Ir("INSERT CHART"),style:4,Ae:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+V(Ts({Ae:"waffle-autovis-lightbox-close",content:Jr(""+V(Xt({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:Ir("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">'+
V(Ts({content:Jr("&#10094;"),style:4,Ae:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:Kr('aria-label="'+Mr("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+V(Ts({content:Jr("&#10095;"),style:4,Ae:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:Kr('aria-label="'+Mr("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
V(a.$Ob)+"</div></div></div>");return W(a)}function eAc(){return W('<div class="waffle-autovis-lightbox-chart"></div>')};function NY(a,b,c,d){P.call(this,d);this.F=a;this.D=b;this.Kb=c;this.H=[];this.C=new Us("",this.xa());this.Xa(this.C);this.O=new Us("",this.xa());this.Xa(this.O);this.L=new Us("",this.xa());this.Xa(this.L);this.J=new Us("",this.xa());this.Xa(this.J)}u(NY,P);p=NY.prototype;p.Ha=function(){NY.ea.Ha.call(this);this.Ma=U(dAc,{$Ob:this.F.length})};
p.Sa=function(){NY.ea.Sa.call(this);var a=R.SP.isEnabled();this.$e(!a);a=this.cb("waffle-autovis-lightbox-close");this.C.pb(a);a=this.cb("waffle-autovis-lightbox-insert");this.O.pb(a);var b=this.cb("waffle-autovis-lightbox-previous");this.L.pb(b);b=this.cb("waffle-autovis-lightbox-next");this.J.pb(b);fAc(this);gAc(this,this.D,!1);this.getHandler().R(document.body,Vba,this.S_b).R(this.Ma,"keydown",this.T_b).R(Um(),"resize",this.W_b).R(this.C,"action",this.close).R(this.O,"action",this.Txb).R(this.L,
"action",this.V_b).R(this.J,"action",this.U_b);b=new eI(this.Ma,this.xa());fI(b);this.Ca(b);a.focus()};function fAc(a){var b=a.cb("waffle-autovis-lightbox-content"),c=a.cb("waffle-autovis-lightbox-content-inner");a=a.cb("waffle-autovis-lightbox-page-count");var d=Sm();a=cp(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;$o(c,d,e);$o(b,d,e+a.height+35)}p.$e=function(a){mq(this.Ma,"waffle-autovis-lightbox-readonly",a)};
function gAc(a,b,c){c&&yo("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?hAc(a,b):a.F[b]&&Twc(a.F[b],t(a.Oqb,a,b),!0)}p.Oqb=function(a,b){if(!this.isDisposed()&&b){var c=this.cb("waffle-autovis-lightbox-container"),d=U(eAc);c.appendChild(d);this.H[a]=d;GW(b,d,this.Kb,Tn);hAc(this,a)}};function hAc(a,b){N(a.H[a.D],!1);N(a.H[b],!0);a.L.fb(!!b);a.J.fb(b!=a.F.length-1);var c=a.cb("waffle-autovis-lightbox-page-number");nn(c,b+1);a.D=b}p.S_b=function(a){!ln(this.Ma,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
p.T_b=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?this.D&&gAc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||iAc(this);a.stopPropagation()};p.W_b=function(){var a=this.cb("waffle-autovis-lightbox-container");an(a);this.H=[];fAc(this);gAc(this,this.D,!0)};p.Txb=function(){this.close();Wwc(this.F[this.D],2256)};p.V_b=function(){this.D&&gAc(this,this.D-1,!0);this.D||this.J.Ma.focus()};p.U_b=function(){iAc(this);this.D==this.F.length-1&&this.L.Ma.focus()};
function iAc(a){a.D!=a.F.length-1&&gAc(a,a.D+1,!0)}p.close=function(){this.dispose()};p.ud=function(){NY.ea.ud.call(this);var a=this.F[this.D];a&&a.Ma&&a.Ma.focus()};function OY(a,b,c,d,e,f){JV.call(this,f);this.Kd=a;this.Xd=b.C;this.Mb=c;this.jg=d;this.Kb=e;this.eb=new MY(b,c,d,e,this.xa());this.Xa(this.eb);this.O=new OW(!1,"#4285f4");this.Xa(this.O);this.J=null;this.Ic=this.yc=!1;this.Wb=!0;this.Rb=ai();this.qb=this.hb="";this.Qa=hj(new gj,10).build()}u(OY,JV);p=OY.prototype;p.Ha=function(){OY.ea.Ha.call(this);this.Ma=U(jAc,{oP:Qn})};
p.Sa=function(){OY.ea.Sa.call(this);var a=this.cb("waffle-assistant-quicksum-panel");this.eb.pb(a);a=this.cb("waffle-assistant-spinner-container");this.O.render(a);a=this.Kd.C;this.getHandler().R(this,"close-sidebar",this.Bra).R(a,"recommender-load-started",this.mra).R(a,"recommender-load-ended",this.lra).R(a,"recommender-calc-started",this.Dqa).R(a,"recommender-calc-ended",this.Cqa).R(this.cb("waffle-assistant-scroll-pane"),"scroll",noc(this.Kga,10,this));a=R.SP.isEnabled();this.$e(!a)};
p.resize=function(){var a=this.cb("waffle-assistant-sidepane-content");a=cp(a).height;var b=this.cb("waffle-assistant-spinner-container");Lo(b,"margin-top",a/2-16+"px");this.Kga()};p.dg=sa;function kAc(a,b){var c=lAc(a);c.length&&(F(a.J),c=c.filter(function(a){return a instanceof iY}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.J=new NY(c,b,a.Kb,a.xa()),a.J.render(),a.Ca(a.J),a.J.$e(a.Ic)))}p.$e=function(a){this.Ic=a;mq(this.Ma,"waffle-assistant-readonly",a);this.eb.$e(a);this.J&&!this.J.isDisposed()&&this.J.$e(a)};
p.setVisible=function(a){var b=this.mb();OY.ea.setVisible.call(this,a);if(a&&!b){var c=ILa(this.Kd.C,a);c?(b=new Pvc,M(b,1,se(c,"r")),M(b,2,se(c,"c")),M(b,3,c.Nh()),c=new dj,Ri(c,4,b),b=jj(kj(this.Qa),c).build()):b=this.Qa;this.qb=bi(this.Rb,hk.zAa,!1,b);this.O.setActive(!0);PY(this)}a||mAc(this,!0)};p.mra=function(){this.mb()&&(mAc(this,!0),this.O.setActive(!0),PY(this))};p.lra=function(){this.mb()&&(this.O.setActive(!1),PY(this))};
p.Dqa=function(a){this.mb()&&(this.Kb.C(2775,this.Qa),mAc(this,void 0,a.F,a.J),nAc(this)||this.O.setActive(!0),PY(this),this.Wb=!1)};
p.Cqa=function(a){if(this.mb()){this.Kb.C(2776,this.Qa);var b=a.L;0<b.length&&(this.hb=bi(this.Rb,hk.xAa));mAc(this,!1);this.O.setActive(!1);a=a.V;for(var c=ka(this.D),d=c.next();!d.done;d=c.next()){d=d.value;for(var e=[],f=ka(b),h=f.next();!h.done;h=f.next()){h=h.value;var k=Ac(h,1);d.U8(k)&&e.push(h)}0<e.length?d.a6(e,a):d.oX(!0)}if(Xn)for(b=ka(b),a=b.next();!a.done;a=b.next())if(a=a.value,5==Ac(a,1)){this.e9();this.Da=B(a,12);this.$=NU(a);this.Ja=B(a,11);oAc(this);a=this.$;c=!1;for(d=this.Ta.length-
1;0<=d;d--)e=this.Ta[d],f=a,e.Ih()&&e.Lb()==f.Lb()&&Nvc(ch(e),ch(f))&&Nvc(dh(e),dh(f))&&(c=!0,this.Ta.splice(d,1));this.Ta.push(a);a=c;2!=this.Da||a||pAc(this,!0)}b=lAc(this);0<b.length&&this.yc&&(b[b.length-1].Db=!0);this.yc=!1;PY(this);qAc(this);this.Kga()}};function PY(a){var b=nAc(a),c=fp(a.cb("waffle-assistant-quicksum-panel")),d=a.O.dc();b=b||c||d;a=a.cb("waffle-assistant-empty-list");N(a,!b)}p.Gc=sa;p.Eva=sa;p.bt=g("Kb");p.Gd=g("Ic");p.Bra=sa;
p.mNb=function(){""!=this.hb&&(ci(this.Rb,this.hb),this.hb="");""!=this.qb&&(ci(this.Rb,this.qb),this.qb="");this.Wb||(this.Kb.hc(2777,this.Qa),this.Wb=!0)};function rAc(){var a=W;var b=""+V(Ts({Ae:"waffle-assistant-datavalidation-apply-button",content:Ir("Apply"),style:4}));b=W(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function sAc(a){return W('<div class="waffle-assistant-datavalidation-detail-chip">'+V(a.nab)+"</div>")};function tAc(a,b){gY.call(this,a,b);this.C=new Us("",this.xa());this.Xa(this.C)}ha(tAc,gY);p=tAc.prototype;p.Ha=function(){gY.prototype.Ha.call(this);hY(this).appendChild(U(rAc))};p.Sa=function(){gY.prototype.Sa.call(this);var a=this.cb("waffle-assistant-datavalidation-apply-button");this.C.pb(a);eY(a,"Apply data validation");this.getHandler().R(this.C,"action",this.Wob)};
p.hF=function(a){var b=$w(gh(NU(this.D))),c=B(B(this.D,13),3);switch(B(c,1)){case 14:var d="Email validation";c=["xyz@gmail.com"];break;case 15:d="URL validation";c=["www.google.com"];break;case 30:d="Date validation";c=["1970/01/01"];break;case 24:d="List of items";c=zc(c,2).map(function(a){return B(B(a,5).Ya(),2)});break;default:Gvc.C("Unrecognized data validation type."),d="unrecognized",c=[]}var e=new uv;b=e.text(d)+(" for "+(e.bf("SPAN".toString(),{lG:"waffle-assistant-datavalidation-range"})+
e.text(b)+e.hf("SPAN".toString())));Gm(this.cb("waffle-assistant-datavalidation-description"),e.format(b));var f=this.cb("waffle-assistant-datavalidation-details");x(c,function(a){a=U(sAc,{nab:a});f.appendChild(a)});a()};p.bF=ba();p.UC=n("assistantDataValidationFeedback");p.oH=n(35551);p.nH=n(35550);p.Wob=function(){this.dispatchEvent(new bY("ye",this,35549))};function uAc(a,b,c){mY.call(this,3,b,a,c)}ha(uAc,mY);p=uAc.prototype;p.pX=n("Data Validation");p.U8=function(a){return 6==a};p.W_=function(a){var b=B(a,1);switch(b){case 6:return new tAc(a,this.xa());default:throw Error("Unsupported recommendation type: "+b);}};p.$e=function(a){mY.prototype.$e.call(this,a);this.setVisible(!a)};p.b6=function(a){return this.Gd()?(this.setVisible(!1),a):mY.prototype.b6.call(this,a)};p.Iga=n(3);function vAc(){var a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+wAc()+"</div>");return W(a)}
function xAc(){return W('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+wAc()+"</div>")}function wAc(){var a=""+V(Ts({Ae:"waffle-assistant-formatting-edit-button",content:Ir("Edit"),style:4}));return W(a)};function yAc(a,b,c){gY.call(this,a,c);a=sb(zc(this.D,7),Eoc);this.C=new MV(!1,a,7);this.Xa(this.C);this.J=new Us("",this.xa());this.Xa(this.J);this.Kb=b;this.H=!1;this.F=-1}u(yAc,gY);var zAc={wha:"waffle-assistant-banding-color-picker-container",Iha:"waffle-assistant-formatting-edit-button",pK:"waffle-assistant-banding-range"};p=yAc.prototype;p.Ha=function(){yAc.ea.Ha.call(this);hY(this).appendChild(U(vAc))};
p.Sa=function(){yAc.ea.Sa.call(this);this.getHandler().R(this.J,"action",this.Dub).R(this.C,"banding-scheme-changed",this.zpb);this.Kb.C(2768)};p.hF=function(a){var b=this.cb(zAc.wha);this.C.render(b);Koc(this.C);b=this.cb(zAc.pK);var c=NU(this.D),d=gh(c);nn(b,$w(d));AAc(this,c);b=this.cb(zAc.Iha);this.J.pb(b);a()};p.bF=function(){uq(this.Ma,"Suggested alternating background colors");ur(this.C,"Choose a color scheme")};p.UC=n("assistantBandingFeedback");p.oH=n(2672);p.nH=n(2671);
p.Dub=function(a){wo.dispatchEvent({type:"show-banding-pane-recommendation",pWa:this.D,T$a:Loc(this.C)});a.stopPropagation()};p.zpb=function(a){if(!this.H&&NV(this.C)){var b=this.F;this.F=this.C.Oh();this.F==b?this.dispatchEvent(new bY("De",this,2797)):this.dispatchEvent(new bY("we",this,2673));a.stopPropagation()}};
function AAc(a,b){a.H=!0;var c=b.Lb();b=gh(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.vc(),b.rc(),b.Nc(),b.Sc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new ah).Pc(Ke.Pa(),c),c=Eoc(c)):c=null;c?(c=Moc(a.C,c),GK(a.C,c?c.getElement():null)):GK(a.C,null);a.F=a.C.Oh();a.H=!1};function BAc(a,b){gY.call(this,a,b);this.C=new Us("",this.xa());this.Xa(this.C);this.yb=zc(a,6)}u(BAc,gY);var QY={Iha:"waffle-assistant-formatting-edit-button",l3a:"waffle-assistant-conditionalformat-format-preview",E5a:"waffle-assistant-conditionalformat-rule-holder",C6:"waffle-assistant-conditionalformat-description",J4a:"one-rule",K6a:"two-rules",x6a:"three-rules",a5a:"waffle-assistant-conditionalformat-format-preview-label"};p=BAc.prototype;p.Ha=function(){BAc.ea.Ha.call(this);hY(this).appendChild(U(xAc))};
p.Sa=function(){BAc.ea.Sa.call(this);var a=this.cb(QY.Iha);this.C.pb(a);eY(a,"Apply and edit conditional format rules");this.getHandler().R(this.C,"action",this.Uob)};p.hF=function(a){nn(this.cb(QY.C6),Ac(this.D,3));var b=this.cb(QY.E5a),c=new CAc(this,this.xa());this.Xa(c);c.pb(b);eY(b,"Apply conditional format rules");a()};p.bF=sa;p.UC=n("assistantConditionalFormatFeedback");p.oH=n(2630);p.nH=n(2629);
p.Uob=function(){this.dispatchEvent(new bY("xe",this,2563));this.dispatchEvent(new bY("Ae",this,2670,void 0,void 0,gh(B(this.yb[0],1,0))));Ao()};function CAc(a,b){rr.call(this,void 0,void 0,b);this.C=a}u(CAc,rr);
CAc.prototype.zd=function(a){CAc.ea.zd.call(this,a);var b=this.C.yb;switch(b.length){case 0:break;case 1:var c=QY.J4a;break;case 2:case 4:c=QY.K6a;break;default:c=QY.x6a}for(var d=0;d<b.length;d++){var e=b[d],f=Wm("DIV");jq(f,[QY.l3a,c]);var h=Wm("DIV");T(h,QY.a5a);f.appendChild(h);nn(h,"123");if(uc(e,2)){var k=B(B(e,2),1);switch(B(B(k,1),1)){case 9:case 13:k=zc(B(k,1),2)[0];var l=zc(e,1)[0];nn(h,uA(k,Ac(l,1),Ac(l,2),Ac(l,4)))}}Qnc(e,f);a.appendChild(f)}};
CAc.prototype.Ci=function(){var a=this.C;a.dispatchEvent(new bY("xe",a,2563));return!0};function DAc(a,b,c){mY.call(this,2,b,a,c)}u(DAc,mY);p=DAc.prototype;p.pX=n("Formatting");p.U8=function(a){return 2==a||4==a};p.W_=function(a){var b=B(a,1);switch(b){case 2:return new BAc(a,this.xa());case 4:return a=new yAc(a,this.bt(),this.xa()),this.getHandler().R(a,"we",this.SXb).R(a,"De",this.pKb),a;default:throw Error("Unsupported recommendation type: "+b);}};p.SXb=function(a){EY(this.hb,"Alternating colors applied",this.xa(),t(this.Apb,this,a.C))};p.pKb=function(){this.hb.clear()};
p.Apb=function(a){this.dispatchEvent(new bY("Ie",a,2796))};p.$e=function(a){DAc.ea.$e.call(this,a);this.setVisible(!a)};p.b6=function(a){return this.Gd()?(this.setVisible(!1),a):DAc.ea.b6.call(this,a)};p.Iga=n(3);function RY(a,b,c,d,e){P.call(this);this.O=a;this.$a=b;this.va=c;this.H=d;this.D=e}ha(RY,P);RY.prototype.getTableRange=g("va");RY.prototype.vfa=function(a,b,c){this.va=a;this.H=b;this.D=c};RY.prototype.Sa=function(){P.prototype.Sa.call(this);this.getHandler().R(this.O.C,"M",this.eb)};RY.prototype.eb=function(){this.$a.Bc()};function EAc(a,b){D.call(this);this.F=a;this.H=b;this.C=new Iyc(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.Ca(this.C);this.D=new Iyc(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.Ca(this.D)}ha(EAc,D);EAc.prototype.La=function(){BY(this.C);BY(this.D);D.prototype.La.call(this)};
function FAc(a,b,c,d,e,f){CCb(b);var h=gh(d);h=new de(h.vc(),h.rc(),Math.min(h.Nc(),h.vc()+6),Math.min(h.Sc(),h.rc()+6));var k=k$a(b),l=$z(a.F).qe(),m=l.Jg(new Td(h.vc(),h.Nc()),"r",!0,!1,!0,!0)-1,r=l.Jg(new Td(h.rc(),h.Sc()),"c",!0,!1,!0,!0)-1;l.qc()&&--r;m=Math.min(200,m);r=Math.min(c.offsetWidth-2,r);DCb(b,k,r,m);c=Nwc(d,e,f);a.H.render(b,h,c);b=a.C;h=d.vc();k=d.rc();switch(e){case 0:h=Math.min(d.Nc(),d.vc()+f);break;case 1:k=Math.min(d.Sc(),d.rc()+f)}d=bh(d.Lb(),h,k,d.Nc(),d.Sc());AY(b,IU(d));
AY(a.D,IU(c))};function GAc(a){var b=a.HVa,c=a.GVa,d=a.fUa;a=a.yFa;return W('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+X(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+V(b)+'</div></div><div class="waffle-tables-popup-content">'+V(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+
V(d)+'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+V(a)+"</div></div></div></div>")}
function HAc(){var a=""+GAc({HVa:Ir("Edit data range"),GVa:Jr(""+W('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Headers<div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>')),fUa:Ir("Update"),
yFa:Ir("Cancel")});return W(a)}function IAc(){var a=""+GAc({HVa:Ir("Improve suggestions"),GVa:Jr('<div class="waffle-tables-popup-header-message"></div>'),fUa:Ir("No"),yFa:Ir("Yes")});return W(a)}function JAc(a){a='For <span class="waffle-assistant-table-bar-range">'+(V(a.kJ)+"</span>");return W(""+a)}function KAc(a){a='Is <span class="waffle-assistant-table-first-header">'+(V(a.aO)+"</span> a header row, containing titles that describe the columns below?");return W(""+a)};function SY(a,b,c,d,e,f,h){RY.call(this,a,R.FZ,d,e,f);this.C=(new pN).build();this.Ca(this.C);this.J=new Ms("",new dY,this.xa());this.Xa(this.J);Bu(this.C,this.J,R.g8);this.F=new Ms("",new dY,this.xa());this.Xa(this.F);Bu(this.C,this.F,R.FZ);this.V=new EAc(b,c);this.Ca(this.V);this.L=new gu(this);this.Ca(this.L);this.Da=h}ha(SY,RY);SY.prototype.Ha=function(){this.Ma=U(IAc)};
SY.prototype.Sa=function(){RY.prototype.Sa.call(this);this.J.pb(this.cb("waffle-tables-popup-done"));this.F.pb(this.cb("waffle-tables-popup-cancel"));var a=Nwc(this.getTableRange(),this.D,1);a=$w(gh(a));a=U(KAc,{aO:a});this.cb("waffle-tables-popup-header-message").appendChild(a);this.L.subscribe(R.g8,"action",this.Ja).subscribe(R.FZ,"action",this.$);a=this.cb("waffle-assistant-table-canvas");var b=this.cb("waffle-assistant-canvas-container");FAc(this.V,a,b,this.getTableRange(),this.D,this.H);a=this.cb("waffle-tables-popup");
mq(a,"waffle-tables-popup-answers-enabled",this.Da);b=new eI(a,this.xa());this.Ca(b);fI(b);a.focus()};SY.prototype.$=function(){this.dispatchEvent("Ge")};SY.prototype.Ja=function(){var a=gh(this.getTableRange());switch(this.D){case 0:a=qda(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=qda(a.top,a.left+1,a.top+a.height,a.left+a.width)}a=$w(a);this.dispatchEvent(new pwc(a,this.H-1,this.D));this.dispatchEvent("Ge")};function LAc(a,b,c,d,e,f,h,k,l){RY.call(this,a,R.qR,d,e,f);var m=this;this.hb=b;this.Ta=d;this.yb=e;this.Db=f;a=gh(d);this.F=$w(a);this.Qa=new EAc(b,c);this.Ca(this.Qa);this.C=null;this.Kb=h;this.J=(new pN).build();this.Ca(this.J);this.$=new Ms("",new dY,this.xa());this.Xa(this.$);Bu(this.J,this.$,R.EZ);this.V=new Ms("",new dY,this.xa());this.Xa(this.V);Bu(this.J,this.V,R.qR);this.L=new OV(this.hb,function(a,b,c){MAc(m,a,b,c)},!1,"e.g., A2:D5",!0,this.O.C.C.C,this.xa());this.Xa(this.L);this.Da=null;
this.Ja=new gu(this);this.Ca(this.Ja);this.kb=k;this.qb=l}ha(LAc,RY);p=LAc.prototype;p.Ha=function(){this.Ma=U(HAc)};
p.Sa=function(){RY.prototype.Sa.call(this);this.$.pb(this.cb("waffle-tables-popup-done"));this.V.pb(this.cb("waffle-tables-popup-cancel"));this.L.render(this.cb("waffle-assistant-tables-data-range-wrapper"));var a=this.cb("waffle-range-selection-input");rq(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().R(a,"keydown",this.KNb).R(a,"keyup",this.LNb).R(a,Wba,this.VHb).R(this.L,"change",this.MNb);this.Ja.subscribe(R.EZ,"action",this.NNb).subscribe(R.qR,"action",this.Wpb);
NAc(this);a=this.cb("waffle-tables-popup");mq(a,"waffle-tables-popup-answers-enabled",this.qb);var b=new eI(a,this.xa());this.Ca(b);fI(b);a.focus()};p.La=function(){F(this.Da);RY.prototype.La.call(this)};function MAc(a,b,c,d){MU(a.kb,null,b,c,d,!1,void 0,function(b){a.Da=b})}function OAc(a){var b=a.cb("waffle-assistant-table-canvas"),c=a.cb("waffle-assistant-canvas-container");FAc(a.Qa,b,c,a.getTableRange(),a.D,a.H)}p.Wpb=function(){this.dispatchEvent("Ge")};
p.NNb=function(){var a=!Rw.test(this.F);N(this.Jb("waffle-assistant-tables-range-error"),a);mq(this.cb("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.yb!=this.H||this.Db!=this.D;var b=!loc(this.Ta,this.getTableRange());if(a||b)a&&this.Kb.hc(35506),b&&this.Kb.hc(35507),this.dispatchEvent(new pwc(this.F,this.H,this.D));this.dispatchEvent("Ge")}};
function NAc(a){var b=a.cb("waffle-range-selection-input"),c=gh(a.Ta);a.F=$w(c);b.value=a.F;PAc(a);OAc(a)}p.vfa=function(a,b,c){RY.prototype.vfa.call(this,a,b,c);OAc(this)};function QAc(a){var b=mw(a.O.C),c=b.zc();if(b=OMa(a.F,b))c=eh(b,c),a.vfa(c,RAc(a,c),a.D),PAc(a)}function RAc(a,b){b=SAc(b,a.D);return a.H>b?b:a.H}function SAc(a,b){a=0==b?a.Nc()-Ac(a,2):a.Sc()-Ac(a,4);return Math.min(a-1,3)}
function PAc(a){F(a.C);a.C=new AI;a.Xa(a.C);Bu(a.J,a.C,R.ija);PU(a.C,QV.getInstance());a.C.render(a.cb("waffle-assistant-tables-edit-headers-button"));a.getHandler().R(a.C,"action",a.Pwb);for(var b=SAc(a.getTableRange(),0),c=0;c<=b;c++){var d=(new Jo("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.C.Nd(new mt(d))}c=SAc(a.getTableRange(),1);for(d=0;d<=c;d++){var e=(new Jo("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.C.Nd(new mt(e))}c=a.H;a.C.Xf(0==a.D?c:c+b+1);rq(a.C.Ma,"label","Headers")}p.VHb=function(){var a=this.cb("waffle-range-selection-input");this.F!=a.value&&(this.F=a.value,QAc(this))};p.MNb=function(){var a=this.L.Ya();this.F=a;var b=this.cb("waffle-range-selection-input");b.value=a;b.select();QAc(this)};
p.KNb=function(a){var b=this.cb("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.F=b.value;QAc(this);R.EZ.Bc();break;case 27:a.stopPropagation(),a.preventDefault(),NAc(this),R.qR.Bc()}};p.LNb=function(){this.F=this.cb("waffle-range-selection-input").value;QAc(this)};p.Pwb=function(){var a=this.C.Oh(),b=SAc(this.getTableRange(),0);this.vfa(this.getTableRange(),a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};function TY(a,b,c,d){bu.call(this,a,b,c,d,void 0,void 0,!0)}u(TY,bu);TY.prototype.Ha=function(){TY.ea.Ha.call(this);T(this.Ma,"waffle-assistant-toast");T(this.cb("docs-ui-toast-content"),"waffle-assistant-toast-content")};TY.prototype.eC=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=qp(this,b);TY.ea.eC.call(this,a,b,c)};TY.prototype.Sh=function(a,b,c,d){this.eC(a,b,d);a=sp(this,b);this.getHandler().Yh(a,cd,t(function(){this.setVisible(!1);c()},this))};function TAc(){this.C=null}u(TAc,D);TAc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function EY(a,b,c,d){a.clear();a.C=new TY(b,c,!1,5E3);a.C.render();d&&a.C.Sh("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}TAc.prototype.La=function(){TAc.ea.La.call(this);this.clear()};function jAc(a){a=a||{};var b=W,c=Jr('<div class="waffle-assistant-replaceable-title">'+UAc()+"</div>");var d=d=a||{};var e=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+V(fxc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');e=d.oP?e+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
e+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";d=W(e+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');d=W(""+('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
d+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return b(V(PV(Hr({title:c,Hl:Jr(""+d),id:Ir("autovis"),pP:Ir("waffle-assistant-sidepanel"),Xfa:Ir("waffle-assistant-title"),U_:Ir("waffle-assistant-sidepane-content")},a))))}
function UAc(){return W('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+V(fxc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+V("Explore")+"</div></div>")};function UY(a,b,c,d,e,f,h,k,l,m){OY.call(this,a,b,c,d,e,m);this.sf=f;this.Db=b;this.$a=new P(this.xa());this.Xa(this.$a);this.va=new TAc;this.Ca(this.va);this.D=[];this.F=null;this.yb=new Us("",m,4);zr(this.yb,2,!1);this.Xa(this.yb);this.Dd=h;this.Jf=k;this.vd=l;this.$=null;this.Da=0;this.Ja=null;this.Xb=new Ms("",new dY,this.xa());this.Xa(this.Xb);this.jc=new P(this.xa());this.Xa(this.jc);this.Xc=(new pN).build();this.Ca(this.Xc);Bu(this.Xc,this.Xb,R.f8);this.V=this.H=null;this.Ta=[]}u(UY,OY);
var VY={rF:"waffle-assistant-scroll-pane-feature-content",Bec:"waffle-assistant-empty-list",Z2a:"waffle-assistant-features",a4a:"waffle-assistant-empty-list-learn-more",Aia:"waffle-assistant-expanded-panel",tCa:"waffle-assistant-replaceable-title",H5a:"waffle-assistant-scroll-pane",s6a:"waffle-assistant-sidepane-tables-range",t6a:"waffle-sidebar-tables-bar",IDa:"waffle-assistant-tables-scroll-pane",u6a:"waffle-assistant-tables-edit-range-button",rR:"waffle-assistant-title"},VAc={defaultHelpArticleId:"6280499"};
p=UY.prototype;
p.Sa=function(){var a=this;UY.ea.Sa.call(this);this.$a.pb(this.cb(VY.Aia));eY(this.C.Ma,"Close");Xn&&(this.jc.pb(this.cb(VY.s6a)),oAc(this),this.Xb.pb(this.cb(VY.u6a)));var b=this.Db.L.fw();Qn&&(vva||"en"==jw(b))&&(b=new KY(this.sf,this.Mb,this.Xd,this.jg,this.bt(),this.va,this.Db,this.Jf,this.vd,this.xa()),this.Xa(b),this.D.push(b));b=new DAc(this.bt(),this.va,this.xa());this.Xa(b);this.D.push(b);Qh(I(),"fedvs")&&(b=new uAc(this.bt(),this.va,this.xa()),this.Xa(b),this.D.push(b));b=new nY(this.Xd,
this.Mb,this.bt(),this.va,this.xa());this.Xa(b);this.D.push(b);var c=this.cb(VY.Z2a);x(this.D,function(b){b.render(c);a.$a.Xa(b.C,!0)});this.yb.pb(this.cb(VY.a4a));this.getHandler().R(this.yb,"action",this.v4b).R(this,"Ge",this.e9).R(this,"Fe",this.w4b);WAc(this)};p.w4b=function(){var a=XAc(this);a&&(a.Da=!0)};p.v4b=function(){Q.So.Bc(VAc)};function qAc(a){x(a.D,function(a){oxc(a)})}function mAc(a,b,c,d){x(a.D,function(a){a.oX(b,c,d)})}function nAc(a){return!!wb(a.D,function(a){return a.Nra()})}
p.Kga=function(){var a=this,b=this.cb("waffle-assistant-scroll-pane").scrollTop+cp(this.cb("waffle-assistant-sidepane-content")).height;x(this.D,function(c){a.F&&a.F!=c||(c instanceof nY&&a.getHandler().Kc(c,"Be",a.mNb),b=c.b6(b))})};function lAc(a){if(a.F)return a.F.C.C;var b=[];x(a.D,function(a){Ib(b,nxc(a))});return b}p.$e=function(a){UY.ea.$e.call(this,a);WAc(this)};p.dg=function(a){x(this.D,function(b){b.dg(a)})};p.Eva=function(){var a=this.cb(VY.tCa),b=this.cb(VY.rR);bp(b,cp(a).height)};
p.Gc=function(){var a=this,b=this.cb(VY.rF),c=this.cb(VY.tCa),d=this.$a.Ma;if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,N(b,!0),N(d,!1),fr(c,UAc),sq(c,"label"),this.resize();else if(this.F=wb(this.D,function(a){return a.dc()}))N(b,!1),N(d,!0),this.F.C.setVisible(!0),pxc(this.F,c),uq(c,this.F.pX());this.Eva();b=new jl(function(){var b=tv;b&&b.dispatchEvent("resize");a.Kga()},300);this.Ca(b);b.start()};
p.setVisible=function(a){var b=this.mb();UY.ea.setVisible.call(this,a);a&&!b&&YAc(this,!0);a||this.va.clear()};p.Bra=function(){UY.ea.Bra.call(this);this.F&&this.Gc();this.e9()};p.mra=function(){UY.ea.mra.call(this);YAc(this,!0)};p.lra=function(){UY.ea.lra.call(this);YAc(this,!1)};p.Dqa=function(a){UY.ea.Dqa.call(this,a);YAc(this,!0,a.F)};p.Cqa=function(a){UY.ea.Cqa.call(this,a);YAc(this,!1)};
function ZAc(a,b){if(Xn){var c=XAc(a);b?(w1b(a.H),a.H=new LAc(a.Db,a.Mb,a.Dd,a.$,a.Da,a.Ja,a.bt(),a.vd,!!c&&c.dc()),a.Xa(a.H),a.H.render(a.getElement())):a.H&&(a.removeChild(a.H,!0),F(a.H),a.H=null);c&&Wzc(c,b)}}function pAc(a,b){if(Xn&&1!=a.Ja){var c=XAc(a);b?(a.V=new SY(a.Db,a.Mb,a.Dd,a.$,a.Da,a.Ja,!!c&&c.dc()),a.Xa(a.V),a.V.render(a.getElement())):a.V&&(a.removeChild(a.V,!0),F(a.V),a.V=null);c&&Wzc(c,b)}}function WAc(a){x(a.D,function(b){b.$e(a.Gd())})}
function XAc(a){return(a=wb(a.D,function(a){return a instanceof KY}))?a:null}function YAc(a,b,c){x(a.D,function(a){c||jxc(a.C,b)});Xn&&b&&(a.$=null,a.Da=0,a.Ja=null,a.e9(),oAc(a))}function oAc(a){var b=a.cb(VY.t6a),c=a.cb(VY.H5a);if(a.$){var d=gh(a.$);d=$w(d);d=U(JAc,{kJ:d});a=a.jc.Yb();an(a);a.appendChild(d);N(b,!0);T(c,VY.IDa)}else N(b,!1),kq(c,VY.IDa)}p.e9=function(){ZAc(this,!1);pAc(this,!1)};function WY(a,b,c,d,e,f,h,k,l,m,r,v){var w=this;KV.call(this,b,h);this.$=a;this.C=b;this.O=c;this.Qa=d;this.hb=e;this.L=f;this.H=c.C;this.Ta=this.Ja=!1;this.F=null;this.Kb=l;this.eb=v;this.qd=new ah;this.J=null;$Ac(this);R.q6.fb(!0);a=new aj;M(a,6,aBc());b=new Zi;Ri(b,58,a);this.va=hj(ij(new gj,b),10).build();this.$a=ai();this.Da=bi(this.$a,hk.wAa);a=new jl(function(){return bBc(w,!1)},100);this.Ca(a);a.start()}u(WY,KV);
function $Ac(a){var b=ww(a.hb);a.Df().R(a.Qa,"selectionChange",a.z4b).R(a.H,"M",a.x4b).R(b,"fa",a.aAb).R(a.C,"ye",a.Yob).R(a.C,"xe",a.Xob).R(a.C,"we",a.Vob).R(a.C,"De",a.sEb).R(a.C,"Ae",a.oqb).R(a.C,"Ce",a.y4b).R(a.C,"He",a.jHb).R(a.C,"Ee",a.PFb).R(a.C,"ze",a.vpb).R(a.C,"Ie",a.B4b).R(a.$.C,"recommender-confidence-update",a.Rrb).R(a.C,"Fe",a.A4b);hu(a.V,R.SP,Hp,a.Wxb).subscribe(R.TP,"action",a.spb).subscribe(R.r6,"action",a.SGb).subscribe(R.bha,"action",a.XUa).subscribe(R.cx,"action",a.IBb).subscribe(R.f8,
"action",a.fHb)}p=WY.prototype;p.Uh=function(){return R.cha};p.Ju=function(){return R.jza};p.Ar=function(a){WY.ea.Ar.call(this,a);R.r6.fb(a);bBc(this,!1);!this.Ja&&a&&(this.Ja=!0);fq(this.eb,{Nb:a})};p.C2=function(a){var b=this;this.C.Eva();var c=new jl(function(){WY.ea.C2.call(b,a)},300);this.Ca(c);c.start()};p.Iqa=function(){WY.ea.Iqa.call(this);XY(this,2226)};p.dg=function(a){this.C.dg(a);this.$.dg(a)};
p.Yob=function(a){var b=a.C.D,c=B(B(b,13),3);b=NU(b);var d=new lf;C(d,1,c);c=new mf;C(c,1,d);C(c,3,!0);C(c,4,!0);this.L.C(new PW(c,b));XY(this,a.yj())};p.spb=function(){var a=this.C.mb();this.Uh().setVisible(!a);a||this.C.focus();a?XY(this,2226):XY(this,2253)};p.XUa=function(){this.C.mb()||this.Ar(!0)};p.IBb=function(){var a=XAc(this.C);a&&!a.dc()&&(this.XUa(),Yzc(a,"",!0))};p.SGb=function(a){kAc(this.C,a)};p.fHb=function(){ZAc(this.C,!0)};p.z4b=function(){yw(this.O)&&!this.C.H&&bBc(this,!0)};
function bBc(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.mb()&&(bAc(d.eb),PY(d));a.$.update(!b,a.C.mb(),c)}
p.Rrb=function(a){""!=this.Da&&(ci(this.$a,this.Da),this.Da="");var b=a.F||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&c.Nh()>=pva&&se(c,"r")>=rva&&se(c,"c")>=sva&&c.Nh()<=qva)&&.6<=b;if(d!==this.Ta||a&&!a.equals(this.F))this.Ta=d,this.F=a,R.q6.Bc({Qca:d,kJ:a});c&&a&&a.rect&&(c=.9<=b,d=1E3>=a.rect.Nh(),a=ritz_api.RitzModelApi.isFormsRegion(""+a.Zc,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),c=!this.C.mb()&&!this.Ja&&c&&d&&!qw(this.O),a=gva&&a,d=hva&&this.O.Gd(),c&&(a||d)&&(c=
new aj,M(c,1,b),M(c,2,a),M(c,3,d),M(c,5,wva),M(c,6,aBc()),b=new Zi,Ri(b,58,c),b=ij(hj(new gj,10),b).build(),this.bFa(b)))};p.bFa=function(a){var b=this;this.C.yc=!0;var c=QZa(mw(this.H));if(!d_b.C&&!c){var d=a||this.va;this.Uh().setVisible(!0);this.Kb.hc(2225,d);XY(this,2253);a=new jl(function(){b.C.mb()||b.Kb.hc(2752,d)},5E3);this.Ca(a);a.start()}};function aBc(){switch(tva){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}
p.vpb=function(){this.C.Gc()};p.B4b=function(a){var b=a.C,c=NU(b.D),d=parseInt(c.Lb(),10);this.J=gh(c);this.L.C(new V_b(d));AAc(b,c);XY(this,a.yj())};p.x4b=function(){Gw(this.H)?(this.C.fb(!0),bBc(this,!1)):(this.Uh().setVisible(!1),this.C.fb(!1))};p.Wxb=function(){this.C.$e(!R.SP.isEnabled())};p.aAb=function(a){bBc(this,!1,bMa(a))};
p.Xob=function(a){var b=mw(this.H),c=""+b.zc(),d=[],e=Rnc(b);if(e){b=new gg;var f=Ac(e,2);C(b,3,f);f=Ac(e,2);C(b,2,f);e=Ac(e,1);C(b,1,e);d.push(b)}b=a.C.yb;for(e=0;e<b.length;e++)f=new gg,C(f,2,b[e]),d.push(f);this.L.C(new HW(d,c));XY(this,a.yj())};
p.Vob=function(a){var b=a.C,c=Loc(b.C),d=NU(b.D),e=c.vv?c.gy:null,f=c.C?c.Jx:null,h=parseInt(d.Lb(),10),k=cBc(d);this.J=gh(d);k?this.L.C(new IV(k,h,this.J,e,c.Ws,c.Rt,f)):this.L.C(new GV(h,this.J,e,c.Ws,c.Rt,f));d=new ioc;M(d,1,1);c=new RU;b=B(b.D,2);M(c,2,b);Ri(c,5,d);b=Pwc(this.F);Ri(b,46,c);b=ij(hj(new gj,10),b).build();this.Kb.C(a.yj(),b)};p.sEb=function(a){a=a.C;var b=NU(a.D),c=parseInt(b.Lb(),10),d=cBc(b);this.J=gh(b);this.L.C(new HV(d,c));AAc(a,b)};
p.A4b=function(a){var b=mw(this.O.C),c=b.zc();b=eh(OMa(a.L,b),c);c=Nwc(b,a.F,a.V);var d=this.$,e=a.F;DLa(d.C);d.C.Ta=b;d.C.Ja=c;d.C.Qa=e;NLa(d.C,!0,!0);XY(this,a.yj())};function cBc(a){var b=a.Lb();a=gh(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.vc(),a.rc(),a.Nc(),a.Sc(),7,!1);return 0<b.length?b[0]:null}p.oqb=function(a){uC(mw(this.H),a.J);XY(this,a.yj())};
p.jHb=function(a){var b=a.C;a=a.yj();if(b instanceof DY||b instanceof HY)XY(this,a);else{var c=lAc(this.C),d=new RU,e=B(b.D,2);c=c.indexOf(b);M(d,1,c);M(d,2,e);e=new Zi;Ri(e,46,d);if(b instanceof iY){(d=b.H)?(b=dBc(this,b,d),b=Irc(b,d,d.jf())):b=null;if(!b)return;Ri(e,39,b)}else if(b instanceof kY){var f=b.D;c=new Yvc;if(b instanceof kY)b=1;else throw Error("Unknown text analysis card type.");f=zc(B(f,8),20).slice(0,10);M(c,2,f||[]);M(c,1,b);Ri(d,3,c)}e=ij(hj(new gj,10),e).build();this.Kb.C(a,e)}};
p.PFb=function(){this.C.Gc()};
p.y4b=function(a){var b=a.L;if(b){var c=mw(this.H),d=a.We();d||(d=$z(this.Qa).ld().C.We());var e=16,f=16,h=a.Ta;h&&(e=h.x,f=h.y);h=Rmc(this.O.J);d={oid:null,ar:BC(c,d.y),ac:CC(c,d.x),x:e,y:f,h:LC.height,w:LC.width,p:{context:{chartName:"Chart "+(h+1)}}};(c=b.jf())?(e=new Ul(c),d=new RE(lw(this.H)||0,d,!1,!1),f=dm(e,"headers"),f=null!=f&&na(f)&&Sa(f)?parseInt(f,10):-1,d.hb=f,d.$=0,f="1"==dm(e,"transpose"),d.$a=f,d.L=f?"ROWS":"COLS",f=dm(e,"range"),f=Vnc(iV(f,","),this.H),d.bJ(f),(e=dm(e,"dt"))&&K5a(d,
this.qd.Pc(tg.Pa(),JSON.parse(decodeURIComponent(e))))):(e=new Ag,C(e,2,"0.6"),f=a.Fd().toJSON(),C(e,1,f),d=new RE(lw(this.H)||0,d,!1,!1,e));KU(d,b);this.Qa.dispatchEvent(new gF("objectRequest"));this.L.C(new sH(this.O,d));e=eBc(this,b,a.V,a.Fd());e.bl(d.getId()||0);CW(this.Kb,a.yj(),e,10,b,c,void 0,a.F)}};function dBc(a,b,c){var d=lAc(a.C).filter(function(a){return a instanceof iY});return eBc(a,c,d.indexOf(b),b.H&&b.H.Fd())}
function eBc(a,b,c,d){var e=new BW;a=lAc(a.C).filter(function(a){return a instanceof iY}).map(function(a){return a.getChartType()});e.O=a;e.H=c;Frc(e,b.getChartType());e.F=d?d.clone():null;return e}function XY(a,b){if(a.F){var c=Pi(mma(a.va),aj,58).getTableRange();if(!c||c.Lb()!=a.F.Zc||c.rc()!=a.F.rect.rc()||c.vc()!=a.F.rect.vc()||c.Sc()!=a.F.rect.Sc()||c.Nc()!=a.F.rect.Nc()){c=new aj;M(c,6,aBc());var d=Owc(a.F);Ri(c,7,d);d=new Zi;Ri(d,58,c);a.va=hj(ij(new gj,d),10).build()}}a.Kb.hc(b,a.va)};function fBc(){D.call(this)}u(fBc,fo);fBc.prototype.C=function(){return Zzc};fBc.prototype.F=function(){return UY};fBc.prototype.D=function(){return WY};to("assistant",fBc);
